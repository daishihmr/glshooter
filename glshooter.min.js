var k=void 0,m=!0,p=null,q=!1;function aa(){return function(){}}var w;
(function(){function a(a){for(;a<=-Math.PI;)a+=2*Math.PI;for(;Math.PI<a;)a-=2*Math.PI;return a}w=function(a){this.lb=a};w.prototype.eb=function(a,c){var b=this.lb.getTopActionLabels();if(c===k&&0<b.length){for(var d=[],v=0,H=b.length;v<H;v++)d[d.length]=this.mb(a,b[v]);for(var E=function(){for(var a=d.length;a--;)d[a].call(this);E.bb==d.length&&(E.complete=m,this.Da&&this.Da())},v=d.length;v--;)d[v].Ra=E;E.bb=0;E.nb=function(){this.bb++};E.bb=0;E.complete=q;E.ac=m;return E}return this.mb(a,c)};w.prototype.mb=
function(a,d){function b(){var a=b.Ub,f=b.Nb;if(f)if(this.fa<b.Ya?b.direction+=b.xa:this.fa===b.Ya&&(b.direction=b.oa),this.fa<b.Za?b.speed+=b.Fa:this.fa===b.Za&&(b.speed=b.Aa),this.fa<b.Va?(b.ta+=b.Ja,b.ua+=b.Ka):this.fa===b.Va&&(b.ta=b.Ha,b.ua=b.Ia),this.x+=Math.cos(b.direction)*b.speed*a.Ta,this.y+=Math.sin(b.direction)*b.speed*a.Ta,this.x+=b.ta*a.Ta,this.y+=b.ua*a.Ta,a.bc(this)){if(a.mc&&(this.direction=(b.direction+Math.PI/2)*c,this.speed=b.speed),!(this.fa<b.Hb||b.cb)){for(var d;d=b.Ib.next();)switch(d.commandName){case "fire":f.Mb.call(this,
d,a,b,f);break;case "wait":a=0;b.Hb="number"===typeof d.value?this.fa+d.value:0!==(a=~~d.value)?this.fa+a:this.fa+eval(d.value);return;case "changeDirection":f.Kb.call(this,d,a,b);break;case "changeSpeed":f.Lb.call(this,d,b);break;case "accel":f.Jb.call(this,d,b);break;case "vanish":this.parent&&this.parent.remove(this)}b.cb=m;b.Ra?b.Ra.nb():this.Da&&this.Da()}}else this.parent&&this.parent.remove(this),b.cb=m,b.Ra?b.Ra.nb():this.Da&&this.Da()}d=d||"top";if("string"===typeof d)b.Ib=this.lb.getWalker(d,
a.Ab);else if(d instanceof BulletML.Bullet)b.Ib=d.getWalker(a.Ab);else throw console.error(a,d),Error("\u5f15\u6570\u304c\u4e0d\u6b63");b.Nb=this;b.Ub=a;b.Hb=-1;b.cb=q;b.direction=0;b.sb=0;b.speed=0;b.ub=0;b.ta=0;b.ua=0;b.xa=0;b.oa=0;b.Ya=-1;b.Fa=0;b.Aa=0;b.Za=-1;b.Ja=0;b.Ha=0;b.Ka=0;b.Ia=0;b.Va=-1;b.ac=m;return b};w.prototype.Mb=function(a,c,b,n){var v=c.Pb({label:a.bullet.label});if(v!==k){n=n.eb(c,a.bullet);var H=this;b.sb=n.direction=function(a){var f=eval(a.value)*d;switch(a.type){case "aim":return c.target?
Math.atan2(c.target.y-H.y,c.target.x-H.x)+f:f-Math.PI/2;case "absolute":return f-Math.PI/2;case "relative":return b.direction+f;default:return b.sb+f}}(a.direction||a.bullet.direction);b.ub=n.speed=function(a){var c=eval(a.value);switch(a.type){case "relative":case "sequence":return b.ub+c;default:return c}}(a.speed||a.bullet.speed);v.x=this.x+((this.width||0)-(v.width||0))/2;v.y=this.y+((this.height||0)-(v.height||0))/2;v.update=n;this.parent!==p&&this.parent.add(v)}};w.prototype.Kb=function(c,g,
b){var n=eval(c.direction.value)*d,v=eval(c.term);switch(c.direction.type){case "aim":c=g.target;if(!c)return;b.oa=Math.atan2(c.y-this.y,c.x-this.x)+n;b.xa=a(b.oa-b.direction)/v;break;case "absolute":b.oa=n-Math.PI/2;b.xa=a(b.oa-b.direction)/v;break;case "relative":b.oa=b.direction+n;b.xa=a(b.oa-b.direction)/v;break;case "sequence":b.xa=n,b.oa=b.direction+b.xa*v}b.Ya=this.fa+v};w.prototype.Lb=function(a,c){var b=eval(a.speed.value),d=eval(a.term);switch(a.speed.type){case "absolute":c.Aa=b;c.Fa=(c.Aa-
c.speed)/d;break;case "relative":c.Aa=b+c.speed;c.Fa=(c.Aa-c.speed)/d;break;case "sequence":c.Fa=b,c.Aa=c.speed+c.Fa*d}c.Za=this.fa+d};w.prototype.Jb=function(a,c){var b=eval(a.term);c.Va=this.fa+b;if(a.horizontal){var d=eval(a.horizontal.value);switch(a.horizontal.type){case "absolute":case "sequence":c.Ja=(d-c.ta)/b;c.Ha=d;break;case "relative":c.Ja=d,c.Ha=(d-c.ta)*b}}else c.Ja=0,c.Ha=c.ta;if(a.vertical)switch(d=eval(a.vertical.value),a.vertical.type){case "absolute":case "sequence":c.Ka=(d-c.ua)/
b;c.Ia=d;break;case "relative":c.Ka=d,c.Ia=(d-c.ua)*b}else c.Ka=0,c.Ia=c.ua};var c=180/Math.PI,d=Math.PI/180})();var A;function ba(a,c){var d=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,d);a.bufferData(a.ARRAY_BUFFER,new Float32Array(c),a.STATIC_DRAW);a.bindBuffer(a.ARRAY_BUFFER,p);return d}function ca(a,c,d){switch(c){case "vs":c=a.createShader(a.VERTEX_SHADER);break;case "fs":c=a.createShader(a.FRAGMENT_SHADER);break;default:return}a.shaderSource(c,d);a.compileShader(c);if(a.getShaderParameter(c,a.COMPILE_STATUS))return c;alert(a.getShaderInfoLog(c))}
A=function(a,c,d){var f=a.getContext("webgl")||a.getContext("experimental-webgl");if(!f)throw alert("failed initialize WebGL"),Error("failed initialize WebGL.");this.Pa=f;f.clearColor(0,0,0,0);f.enable(f.BLEND);f.blendFunc(f.SRC_ALPHA,f.ONE);a=ca(f,"vs",c);d=ca(f,"fs",d);c=f.createProgram();f.attachShader(c,a);f.attachShader(c,d);f.linkProgram(c);f.getProgramParameter(c,f.LINK_STATUS)?(f.useProgram(c),d=c):(alert(f.getProgramInfoLog(c)),d=k);var g=this.fc=d;d=f.getAttribLocation(g,"position");a=ba(f,
la);f.bindBuffer(f.ARRAY_BUFFER,a);f.enableVertexAttribArray(d);f.vertexAttribPointer(d,3,f.FLOAT,q,0,0);d=f.getAttribLocation(g,"texCoord");a=ba(f,ma);f.bindBuffer(f.ARRAY_BUFFER,a);f.enableVertexAttribArray(d);f.vertexAttribPointer(d,2,f.FLOAT,q,0,0);this.Eb=mat4.identity(mat4.create());this.zb=mat4.identity(mat4.create());mat4.lookAt([0,0,16],[0,0,0],[0,1,0],this.Eb);mat4.perspective(90,1,0.1,32,this.zb);f.activeTexture(f.TEXTURE0);f.uniform1f(f.getUniformLocation(g,"texture"),0);var b={};"x y scale rotation texX texY alpha texScale emission".split(" ").map(function(a){b[a]=
f.getUniformLocation(g,a)});this.kc=b;this.lc();this.children=[];this.Ga=[];this.frame=0};A.prototype.lc=function(){var a=this.Pa,c=this.fc;a.uniformMatrix4fv(a.getUniformLocation(c,"vMat"),q,this.Eb);a.uniformMatrix4fv(a.getUniformLocation(c,"pMat"),q,this.zb)};A.prototype.update=function(){for(var a=this.children,c=this.Ga,d=0,f=a.length;d<f;d++)a[d].update();d=0;for(f=c.length;d<f;d++){var g=this.children.indexOf(c[d]);-1!=g&&a.splice(g,1)}this.Ga=[]};
A.prototype.clear=function(){var a=this.Pa;a.clear(a.COLOR_BUFFER_BIT)};A.prototype.draw=function(){var a=this.children,c=this.Pa;c.clear(c.COLOR_BUFFER_BIT);for(var d=0,f=a.length;d<f;d++)a[d].draw(c);c.flush();this.frame++};A.prototype.add=function(a){var c=this.children;c[c.length]=a;a.parent=this;a.Db=this.kc};A.prototype.remove=function(a){a.parent===this&&(a.parent=p,this.Ga[this.Ga.length]=a,a.ya())};var la=[-1,1,0,-1,-1,0,1,1,0,1,-1,0],ma=[0,0,0,0.125,0.125,0,0.125,0.125];var F;F=function(a){this.fa=0;this.parent=p;this.y=this.x=0;this.scale=1;this.ga=this.da=this.rotation=0;this.Cb=1;this.visible=m;this.alpha=1;this.Ma=this.na=0;this.jc=a;this.Db={};this.update=aa();this.ya=aa()};
F.prototype.draw=function(a){if(this.visible){a.bindTexture(a.TEXTURE_2D,this.jc);var c=this.Db;a.uniform1f(c.x,this.x);a.uniform1f(c.y,this.y);a.uniform1f(c.scale,this.scale);a.uniform1f(c.rotation,this.rotation);a.uniform1f(c.texX,this.da);a.uniform1f(c.texY,this.ga);a.uniform1f(c.texScale,this.Cb);a.uniform1f(c.alpha,this.alpha);a.uniform1f(c.emission,this.Ma);a.drawArrays(a.TRIANGLE_STRIP,0,4);0<this.na&&(a.bindTexture(a.TEXTURE_2D,F.wb),a.uniform1f(c.texX,4),a.uniform1f(c.texY,1),a.uniform1f(c.texScale,
1),a.uniform1f(c.alpha,this.na),a.uniform1f(c.scale,2*this.scale),a.drawArrays(a.TRIANGLE_STRIP,0,4),a.drawArrays(a.TRIANGLE_STRIP,0,4));this.fa++}};F.wb=p;var ta=[16E3,16E3,16E3];function Da(a,c){for(var d=tm.util.Random,f=[],g=[],b=0;600>b;b++){var n=new F(c);n.da=5;n.ga=1;n.hb=0.2;n.update=function(){this.scale+=this.hb;this.alpha*=0.9;0.0010>this.alpha&&(a.remove(this),g.push(this))};f.push(n);g.push(n)}this.Na=function(b,c,f){for(var n=d.randint(1,3);n--;){var L=g.pop();if(L===k)break;L.scale=0;L.alpha=1;L.x=b+d.randfloat(-0.2,0.2);L.y=c+d.randfloat(-0.2,0.2);L.hb=0.2*f;a.add(L)}};this.qb=function(b,c,f){var n=g.pop();n!==k&&(n.scale=0,n.alpha=0.6,n.x=b+d.randfloat(-0.2,
0.2),n.y=c+d.randfloat(-0.2,0.2),n.hb=0.2*f,a.add(n))};this.$a=function(){for(var a=f.length;a--;)f[a].alpha=0};this.rb=function(a){function b(){var d=new F(c);d.da=4;d.ga=1;d.radius=0;d.ja=0;d.update=function(){this.fa+=1;60>this.fa?this.visible=q:(this.visible=m,this.x=Math.cos(this.ja)*this.radius,this.y=Math.sin(this.ja)*this.radius,this.radius+=this.za,this.scale+=0.17,this.alpha-=0.0025,0>this.alpha&&a.remove(this))};return d}for(var d=[],f=0;30>f;f++)d.push(b());return function(b){function c(){f===
d.length?b():setTimeout(c,5)}for(var f=0,g=d.length;g--;){var j=d[g];j.radius=tm.util.Random.randfloat(0.1,2);j.ja=2*g%12*Math.PI/12-0.3*j.radius;j.za=tm.util.Random.randfloat(0.02,0.15);j.alpha=1;j.scale=1;j.fa=0;j.x=Math.cos(j.ja)*j.radius;j.y=Math.sin(j.ja)*j.radius;j.visible=q;j.ya=function(){f+=1};a.add(j)}G||tm.sound.SoundManager.get("bomb").play();c()}}};var Ia,Ja,Ma,Na,Oa,Pa,Qa;Ia=function(a){var c=tm.app.Label("",30);c.update=function(c){var f=0.25*Math.sin(0.1*c.frame)+0.75;this.alpha=0>a.y&&!a.disabled?(a.y+17)/30*f:f;this.text="SCORE:"+~~c.score};c.setFontFamily("Orbitron");c.setBaseline("bottom");c.x=2;c.y=320;c.width=320;return c};
Ja=function(a){var c=tm.app.Label("",10);c.setFontFamily("Orbitron");c.setBaseline("bottom");c.width=320;c.x=4;c.y=288;c.update=function(c){var f=0.25*Math.sin(0.1*c.frame)+0.75;this.alpha=0>a.y?(a.y+17)/30*f:f;c.pa=Math.max(c.score,c.pa);this.text="high score:"+~~c.pa};return c};Ma=function(){var a=tm.app.Label("",12);a.update=function(a){this.alpha=0.25*Math.sin(0.1*a.frame)+0.75;this.text="LIFE:"+a.qa};a.setFontFamily("Orbitron");a.setBaseline("top");a.x=2;a.y=12;a.width=320;return a};
Na=function(){var a=tm.app.Label("",50);a.setFontFamily("Orbitron");a.setAlign("center");a.setBaseline("middle");a.x=160;a.y=160;a.width=320;a.update=function(a){this.alpha=0.1+0.1*Math.sin(0.12*a.frame)};return a};Oa=function(){var a=tm.app.Label("",12);a.update=function(a){this.alpha=0.25*Math.sin(0.1*a.frame)+0.75;this.text="BOMB:"+a.la};a.setFontFamily("Orbitron");a.setBaseline("top");a.x=2;a.y=26;a.width=320;return a};
Pa=function(){var a=tm.app.Label("fps:",10);a.setFontFamily("Orbitron");a.setBaseline("top");a.width=50;a.x=320-a.width;a.y=24;var c=-1,d=Date.now();a.update=function(a){this.alpha=0.25*Math.sin(0.1*a.frame)+0.75;c+=1;a=Date.now();1E3<=a-d&&(this.text="fps:"+c,d=a,c=0)};return a};
Qa=function(a){var c=tm.app.RectangleShape(300,5,{fillStyle:"white",strokeStyle:"none"});c.x=155;c.y=5;c.update=function(c){this.alpha=0.25*Math.sin(0.1*c.frame)+0.75;this.width=300*Math.max(1,a.Qa-a.ra)/a.Qa;1>=this.width&&this.remove();this.x=0.5*this.width+5};return c};var Ra,Sa,Ta,Ua,Va,Wa;function I(a,c,d,f){a=this.label=tm.app.Label(a,c);a.fillStyle="#333";a.setFontFamily("Orbitron");a.setAlign("center");a.setBaseline("middle");a.width=320;a.x=d;a.y=f;a.addEventListener("enterframe",function(a){this.alpha=0.25*Math.sin(0.1*a.app.frame)+0.75});return a}
Ra=tm.createClass({superClass:tm.app.Scene,init:function(){this.superInit();this.Ua=q;var a=tm.graphics.LinearGradient(0,0,0,320);a.addColorStopList([{offset:0,color:"rgba(0,0,255,0.3)"},{offset:1,color:"rgba(0,0,255,0.0)"}]);a=this.Xa=tm.app.RectangleShape(320,320,{fillStyle:a.toStyle(),strokeStyle:"none"});a.x=160;a.y=160;a.blendMode="lighter";this.addChild(a);a=tm.graphics.LinearGradient(0,0,20,30);a.addColorStopList([{offset:0,color:"rgba(255,255,255,1.0)"},{offset:0.5,color:"rgba(120,120,255,1.0)"},
{offset:1,color:"rgba(255,255,255,1.0)"}]);var c=this.title=tm.app.Label("GL-Shooter",35);c.fillStyle=a.toStyle();c.setFontFamily("Orbitron");c.setAlign("center");c.setBaseline("middle");c.width=320;c.x=160;c.y=100;c.alpha=0;this.addChild(c);a=this.version=tm.app.Label("version 1.0 beta",10);a.setFontFamily("Orbitron");a.setAlign("end");a.setBaseline("middle");a.width=320;a.x=270;a.y=120;a.alpha=0;this.addChild(a);this.$=[];a=this.$[0]=I("game start",20,160,210);this.addChild(a);a=this.$[1]=I("setting",
20,160,250);this.addChild(a);a=this.$[2]=I("exit",20,160,290);this.addChild(a);this.selection=0;this.addEventListener("enter",function(){this.Ua=q;this.title.visible=m;this.version.visible=m;this.Xa.visible=m;this.title.alpha=0;this.version.alpha=0;this.$.forEach(function(a){a.visible=m})})},update:function(a){if(!this.Ua){if(a.keyboard.getKeyDown("down"))this.selection+=1,this.selection===this.$.length&&(this.selection=0);else if(a.keyboard.getKeyDown("up"))this.selection-=1,-1===this.selection&&
(this.selection=this.$.length-1);else if(1<a.pointing.deltaPosition.length())for(var c=320*a.pointing.x/parseInt(a.element.style.width),d=320*a.pointing.y/parseInt(a.element.style.height),f=this.$.length;f--;)this.$[f].isHitPointRect(c,d)&&(this.selection=f);if(a.keyboard.getKeyDown("space")||a.pointing.getPointingEnd())switch(this.selection){case 0:this.Ua=m;G||tm.sound.SoundManager.get("effect0").play();break;case 1:a.pointing.button=0;a.pointing.update();a.pushScene(a.Bb);break;case 2:a.fb()}}for(f=
this.$.length;f--;)this.$[f].fillStyle="#333";this.$[this.selection].fillStyle="#fff";this.Ua?(this.title.alpha-=0.01,this.version.alpha-=0.01,0>=this.title.alpha&&(this.title.visible=q,this.version.visible=q,this.Xa.visible=q,this.$.forEach(function(a){a.visible=q}),a.pushScene(a.$b),a.kb())):(this.title.alpha+=0.01,this.version.alpha+=0.01,1<this.title.alpha&&(this.title.alpha=1),1<this.version.alpha&&(this.version.alpha=1));a=tm.app.Sprite(32,32,tm.graphics.TextureManager.get("texture0"));a.setFrameIndex(12,
64,64);a.dir=2*Math.random()*Math.PI;a.x=160*Math.cos(a.dir);a.y=160*Math.sin(a.dir);a.alpha=0;a.update=function(){this.alpha+=0.01;this.x-=Math.cos(this.dir);this.y-=Math.sin(this.dir);this.scale.x+=0.01;this.scale.y+=0.01;2>this.x*this.x+this.y*this.y&&this.remove()};this.Xa.addChild(a)}});
Sa=tm.createClass({superClass:tm.app.Scene,init:function(){this.superInit();var a=tm.app.RectangleShape(320,320,{fillStyle:"rgba(0,0,0,0.7)",strokeStyle:"none"});a.x=160;a.y=160;this.addChild(a);a=I("pause",35,160,60);a.fillStyle="#ffffff";this.addChild(a);this.$=[];this.$[0]=I("resume",20,160,130);this.$[1]=I("restart stage",20,160,180);this.$[2]=I("setting",20,160,230);this.$[3]=I("back to title",20,160,280);for(a=this.$.length;a--;)this.addChild(this.$[a]);this.selection=0;this.addEventListener("enter",
function(){this.selection=0})},update:function(a){if(a.keyboard.getKeyDown("down"))this.selection+=1,this.selection===this.$.length&&(this.selection=0);else if(a.keyboard.getKeyDown("up"))this.selection-=1,-1===this.selection&&(this.selection=this.$.length-1);else if(1<a.pointing.deltaPosition.length())for(var c=320*a.pointing.x/parseInt(a.element.style.width),d=320*a.pointing.y/parseInt(a.element.style.height),f=this.$.length;f--;)this.$[f].isHitPointRect(c,d)&&(this.selection=f);if(a.keyboard.getKeyDown("space")||
a.pointing.getPointingEnd())switch(this.selection){case 0:a.popScene();break;case 1:a.pushScene(a.ob);break;case 2:a.pointing.button=0;a.pointing.update();a.pushScene(a.Bb);break;case 3:a.pointing.button=0,a.pointing.update(),a.pushScene(a.ob)}for(f=this.$.length;f--;)this.$[f].fillStyle="#333";this.$[this.selection].fillStyle="#fff"}});
Ta=tm.createClass({superClass:tm.app.Scene,init:function(){this.superInit();var a=tm.app.RectangleShape(320,320,{fillStyle:"rgba(0,0,0,0.9)",strokeStyle:"none"});a.x=160;a.y=160;this.addChild(a);a=I("really?",35,160,60);a.fillStyle="#ffffff";this.addChild(a);this.$=[];this.$[0]=I("ok",20,80,160);this.$[1]=I("no",20,240,160);for(a=this.$.length;a--;)this.addChild(this.$[a]);this.selection=1;this.addEventListener("enter",function(){this.selection=1})},update:function(a){if(a.keyboard.getKeyDown("right"))this.selection+=
1,this.selection===this.$.length&&(this.selection=0);else if(a.keyboard.getKeyDown("left"))this.selection-=1,-1===this.selection&&(this.selection=this.$.length-1);else if(1<a.pointing.deltaPosition.length())for(var c=320*a.pointing.x/parseInt(a.element.style.width),d=320*a.pointing.y/parseInt(a.element.style.height),f=this.$.length;f--;)this.$[f].isHitPointRect(c,d)&&(this.selection=f);if(a.keyboard.getKeyDown("space")||a.pointing.getPointingEnd())switch(this.selection){case 0:1===a.ib.selection?
(a.va+=1,a.Sa(),a.kb(),a.popScene(),a.popScene()):3===a.ib.selection&&(a.va=0,a.wa=1,a.Sa(),a.popScene(),a.popScene(),a.popScene(),a.pointing.button=0,a.pointing.update(),a.ba&&a.ba.stop());break;case 1:a.popScene()}for(f=this.$.length;f--;)this.$[f].fillStyle="#333";this.$[this.selection].fillStyle="#fff"}});
Ua=tm.createClass({superClass:tm.app.Scene,init:function(a){this.superInit();var c=tm.app.RectangleShape(320,320,{fillStyle:"rgba(0,0,0,0.97)",strokeStyle:"none"});c.x=160;c.y=160;this.addChild(c);c=I("setting",35,160,60);c.fillStyle="#ffffff";this.addChild(c);this.$=[];this.$[0]=I("bgm",20,100,130);this.$[1]=I("sound",20,100,180);this.$[2]=I("back",20,100,280);for(c=this.$.length;c--;)this.$[c].setAlign("left"),this.addChild(this.$[c]);var d=this.jb={ba:0,ia:0},c=JSON.parse(localStorage.getItem("jp.dev7.glshooter.settings"));
d.ba=c.ba;d.ia=c.ia;this.selection=0;this.addEventListener("enter",function(){var a=JSON.parse(localStorage.getItem("jp.dev7.glshooter.settings"));d.ba=a.ba;d.ia=a.ia;this.selection=0});this.La=function(c,g){switch(c){case 0:d.ba+=0.01*g;d.ba=Math.clamp(d.ba+0.01*g,0,1);a.Fb=d.ba;a.ba&&(a.ba.volume=d.ba);break;case 1:d.ia=Math.clamp(d.ia+0.01*g,0,1),a.Gb=d.ia}};this.addEventListener("exit",function(){var a=JSON.parse(localStorage.getItem("jp.dev7.glshooter.settings"));a.ba=d.ba;a.ia=d.ia;localStorage.setItem("jp.dev7.glshooter.settings",
JSON.stringify(a))})},update:function(a){var c=320*a.pointing.x/parseInt(a.element.style.width),d=320*a.pointing.y/parseInt(a.element.style.height);if(a.keyboard.getKeyDown("down"))this.selection+=1,this.selection===this.$.length&&(this.selection=0);else if(a.keyboard.getKeyDown("up"))this.selection-=1,-1===this.selection&&(this.selection=this.$.length-1);else if(1<a.pointing.deltaPosition.length())for(var f=this.$.length;f--;)this.$[f].isHitPointRect(c,d)&&(this.selection=f);a.keyboard.getKey("right")?
this.La(this.selection,1):a.keyboard.getKey("left")&&this.La(this.selection,-1);if(1===this.selection&&!G&&(a.keyboard.getKeyUp("right")||a.keyboard.getKeyUp("left")||a.pointing.getPointingEnd()))d=tm.sound.SoundManager.get("explode"),d.volume=this.jb.ia,d.play(),console.log("play");if(a.keyboard.getKeyDown("space")||a.pointing.getPointing())switch(this.selection){case 0:case 1:160>c?this.La(this.selection,-1):this.La(this.selection,1);break;case 2:a.hc(),a.popScene(),a.pointing.button=0,a.pointing.update()}for(f=
this.$.length;f--;)this.$[f].fillStyle="#333";this.$[this.selection].fillStyle="#fff";this.$[0].text="bgm          "+~~(100*this.jb.ba);this.$[1].text="sound      "+~~(100*this.jb.ia)}});
Va=tm.createClass({superClass:tm.app.Scene,init:function(){this.superInit();var a=this.gb=tm.app.Label("Game Over",35);a.fillStyle="rgba(0,0,255,0.6)";a.setFontFamily("Orbitron");a.setAlign("center");a.setBaseline("middle");a.width=320;a.x=160;a.y=160;a.alpha=0;this.addChild(a);this.addEventListener("enter",function(a){this.start=a.app.frame})},update:function(a){this.gb.alpha+=0.01;if(0.5<this.gb.alpha){this.update=aa();a.pa=Math.max(a.score,a.pa);var c="SCORE: "+~~a.pa+" (stage: "+a.wa+", continue: "+
a.va+")";console.log("entry 9leap",~~a.pa,c);tm.social.Nineleap.postRanking(~~a.pa,c)}}});
Wa=tm.createClass({superClass:tm.app.Scene,init:function(){this.superInit();var a=tm.app.RectangleShape(320,320,{fillStyle:"rgba(0,0,0,0.3)",strokeStyle:"none"});a.x=160;a.y=160;this.addChild(a);a=I("continue?",35,160,60);a.fillStyle="#ffffff";this.addChild(a);this.$=[];this.$[0]=I("yes",20,80,160);this.$[1]=I("no",20,240,160);for(a=this.$.length;a--;)this.addChild(this.$[a]);this.selection=0;this.addEventListener("enter",function(){this.selection=0})},update:function(a){if(a.keyboard.getKeyDown("right"))this.selection+=
1,this.selection===this.$.length&&(this.selection=0);else if(a.keyboard.getKeyDown("left"))this.selection-=1,-1===this.selection&&(this.selection=this.$.length-1);else if(1<a.pointing.deltaPosition.length())for(var c=320*a.pointing.x/parseInt(a.element.style.width),d=320*a.pointing.y/parseInt(a.element.style.height),f=this.$.length;f--;)this.$[f].isHitPointRect(c,d)&&(this.selection=f);if(a.keyboard.getKeyDown("space")||a.pointing.getPointingEnd())switch(a.popScene(),this.selection){case 0:a.Zb();
return;case 1:a.fb();return}for(f=this.$.length;f--;)this.$[f].fillStyle="#333";this.$[this.selection].fillStyle="#fff"}});BulletML.dsl();var J={};function K(a){return new w(new BulletML.Root(a))}function Xa(a,c){return K({top:action(wait(a+"+$rand*5"),changeDirection(direction(45*c,"absolute"),1),changeSpeed(speed(4),60),wait(60),changeSpeed(speed(0),10),wait(10),repeat(5,action(fire(direction("$rand*10-5"),speed("2+$rank"),bullet()),wait(2))),changeDirection(direction(160*c,"absolute"),1),changeSpeed(speed(4),40))})}J.zako1=Xa(0,1);J.zako1d=Xa(40,1);J.zako2=Xa(0,-1);J.zako2d=Xa(45,-1);
J.zako3=K({top:action(wait("$rand*5"),changeDirection(direction(0,"aim"),1),changeSpeed(speed(4),40),wait(20),repeat(3,action(fire(direction("$rand*10-5"),speed("2+$rank"),bullet()),wait(5))))});
J.zako4=K({top:action(wait("$rand*20"),changeDirection(direction(0,"absolute"),1),changeSpeed(speed(3),1),wait("5+$rand*20"),changeSpeed(speed(0.2),30),wait(30),actionRef("attack"),changeSpeed(speed(-3),30)),attack:action(wait("5+$rand*20"),repeat(2,action(fire(direction(-6,"aim"),speed("1.4+$rank"),bullet()),fire(direction(4,"sequence"),speed("1.5+$rank"),bullet()),fire(direction(4,"sequence"),speed("1.6+$rank"),bullet()),fire(direction(4,"sequence"),speed("1.7+$rank"),bullet()),wait(90))))});
J.zako4K=K({top:action(wait("$rand*20"),changeDirection(direction(0,"absolute"),1),changeSpeed(speed(3),1),wait("5+$rand*20"),changeSpeed(speed(0.2),30),wait(30),actionRef("attack"),changeSpeed(speed(-3),30)),attack:action(wait("5+$rand*20"),repeat(2,action(fire(direction(-6,"aim"),speed("0.8+$rank"),bullet()),fire(direction(4,"sequence"),speed(0.1,"sequence"),bullet()),fire(direction(4,"sequence"),speed(0.1,"sequence"),bullet()),fire(direction(4,"sequence"),speed(0.1,"sequence"),bullet()),wait(90))))});
J.zako5=K({top:action(wait("$rand*20"),changeDirection(direction(0,"absolute"),1),changeSpeed(speed(3),1),wait("5+$rand*20"),changeSpeed(speed(0.2),30),wait(30),actionRef("attack"),changeSpeed(speed(-3),30)),attack:action(wait("5+$rand*20"),repeat(2,action(fire(direction("$rand*10-5"),speed("2.2+$rank"),bullet()),repeat(12,action(wait(3),fire(direction(0,"sequence"),speed(0.2,"sequence"),bullet()))),wait(80))))});
J.zako5K=K({top:action(wait("$rand*20"),changeDirection(direction(0,"absolute"),1),changeSpeed(speed(3),1),wait("5+$rand*20"),changeSpeed(speed(0.2),30),wait(30),actionRef("attack"),changeSpeed(speed(-3),30)),attack:action(wait("5+$rand*20"),fire(direction(-22.5),speed("0.6+$rank"),bullet()),repeat(3,action(fire(direction(15,"sequence"),speed(0,"sequence"),bullet()))),wait(80))});
J.zako6=K({top:action(changeDirection(direction(0,"absolute"),1),changeSpeed(speed(3),1),wait("5+$rand*20"),changeSpeed(speed(0.3),30),wait(45),actionRef("attack"),changeSpeed(speed(-3),30)),attack:action(repeat(8,actionRef("firebit","$rand*360")),wait(90),repeat(8,actionRef("firebit","$rand*360")),wait(90)),firebit:action(fire(direction("$1","aim"),speed("0.5+$rand"),bulletRef("bit","$1"))),bit:bullet(action(wait("10+$rank*3"),fire(direction("$1*-1","relative"),speed("3.4+$rank"),bullet()),vanish()))});
J.zako6K=K({top:action(changeDirection(direction(0,"absolute"),1),changeSpeed(speed(3),1),wait("5+$rand*20"),changeSpeed(speed(0.3),30),wait(45),actionRef("attack"),changeSpeed(speed(-3),30)),attack:action(repeat(8,actionRef("firebit","$rand*360")),wait(90),repeat(8,actionRef("firebit","$rand*360")),wait(90)),firebit:action(fire(direction("$1","aim"),speed("0.5+$rand"),bulletRef("bit","$1"))),bit:bullet(action(wait("10+$rank*3"),fire(direction("$1*-1","relative"),speed("0.8+$rank"),bullet("g")),vanish()))});
J.zako7=K({top:action(wait("5+$rand*60"),changeDirection(direction("0","absolute"),1),wait(5),changeDirection(direction("$rand*10-5"),30),changeSpeed("2.9+$rank",1),wait(15),fire(direction("$rand*5-2.5"),speed("3.4+$rank"),bullet()),wait(15),changeDirection(direction(0),30),wait(15),changeDirection(direction(0),30))});
J.zako8=K({top1:action(changeDirection(direction(0,"absolute"),1),changeSpeed(speed(5),1),wait(20),changeSpeed(speed(-0.2),60),wait(400),changeSpeed(speed(-5),30)),top2:action(wait(90),fire(direction(20,"absolute"),speed("2.2+$rank"),bullet()),repeat(50,action(fire(direction(-0.5,"sequence"),speed("2.2+$rank"),bullet()),wait(6)))),top3:action(wait(90),fire(direction(-20,"absolute"),speed("2.2+$rank"),bullet()),repeat(50,action(fire(direction(0.5,"sequence"),speed("2.2+$rank"),bullet()),wait(6))))});
function Ya(a){return K({top:action(wait("$rand*20"),changeDirection(direction(90,"absolute"),1),changeSpeed(speed("$rand*10-5"),1),wait(10),changeDirection(direction(0,"absolute"),1),changeSpeed(speed(3),1),wait("15+$rand*10"),changeSpeed(speed(0.2),30),wait(30),actionRef("attack"),changeSpeed(speed(-3),30)),attack:a})}J.zakoG1=Ya(action(wait(20),fire(direction("$rand*20-10"),speed("2.2+$rank"),bullet()),wait(60),fire(direction("$rand*20-10"),speed("2.2+$rank"),bullet()),wait(120)));
J.zakoG2=Ya(action(wait(20),repeat(2,action(fire(direction("$rand*20-10"),speed("2.2+$rank"),bullet()),repeat(2,action(wait(3),fire(direction(0,"sequence"),speed(0,"sequence"),bullet()))),wait(60))),wait(60)));J.zakoG3=Ya(action(wait(20),repeat(2,action(fire(direction("$rand*20-10"),speed("2.2+$rank"),bullet()),fire(direction(-30,"sequence"),speed(0,"sequence"),bullet()),fire(direction(60,"sequence"),speed(0,"sequence"),bullet()),wait(60))),wait(60)));
J.bigger=K({top:action(changeDirection(direction(0,"absolute"),1),changeSpeed(speed(2),1),wait(30),changeDirection(direction(90,"absolute"),1),changeSpeed(speed(0.2),1),actionRef("attack"),repeat(30,action(changeDirection(direction(-90,"absolute"),1),actionRef("attack"),actionRef("attack"),changeDirection(direction(90,"absolute"),1),actionRef("attack"),actionRef("attack")))),attack:action(repeat(2,action(repeat("1+$rank*5",action(fire(direction(-30,"aim"),speed("2+$rank"),bullet()),fire(direction(20,
"sequence"),speed("2+$rank"),bullet()),fire(direction(20,"sequence"),speed("2+$rank"),bullet()),fire(direction(20,"sequence"),speed("2+$rank"),bullet()),wait(5))),wait(10),repeat("1+$rank*5",action(fire(direction(-40,"aim"),speed("2+$rank"),bullet("g")),fire(direction(20,"sequence"),speed("2+$rank"),bullet("g")),fire(direction(20,"sequence"),speed("2+$rank"),bullet("g")),fire(direction(20,"sequence"),speed("2+$rank"),bullet("g")),fire(direction(20,"sequence"),speed("2+$rank"),bullet("g")),wait(5))),
wait(10))))});function Za(a,c){return K({top:action(wait(a),changeDirection(direction(c,"absolute"),1),changeSpeed(speed(0.5),1),wait("60+$rand*100"),repeat(30,action(fire(speed("1.5+$rank"),bullet("sg")),wait("60+$rand*100"))))})}
function O(a,c){return K({top1:action(wait(a),changeDirection(direction(c,"absolute"),1),changeSpeed(speed(0.8),1),wait(180),changeDirection(direction(0.5*c,"absolute"),60)),top2:action(wait(90),wait("$rand*10"),repeat(30,action(fire(direction("$rand*20-10"),speed("1.5+$rank"),bullet("sg")),wait("100+(40-$rank*40)+$rand*10"))))})}J.tank1=Za(0,80);J.tank1d=Za(30,80);J.tank1dd=Za(60,80);J.tank2=Za(0,-80);J.tank2d=Za(30,-80);J.tank2dd=Za(60,-80);J.tank3R0=O(0,-80);J.tank3R1=O(30,-80);
J.tank3R2=O(60,-80);J.tank3R3=O(90,-80);J.tank3R4=O(120,-80);J.tank3L0=O(0,80);J.tank3L1=O(30,80);J.tank3L2=O(60,80);J.tank3L3=O(90,80);J.tank3L4=O(120,80);J.tank4R0=O(0,-150);J.tank4R1=O(30,-150);J.tank4R2=O(60,-150);J.tank4R3=O(90,-150);J.tank4R4=O(120,-150);J.tank4L0=O(0,150);J.tank4L1=O(30,150);J.tank4L2=O(60,150);J.tank4L3=O(90,150);J.tank4L4=O(120,150);
function S(a,c){return K({top:action(wait(a),changeDirection(direction(c,"absolute"),1),changeSpeed(speed(0.8),1),wait(140),changeDirection(direction(2*c,"absolute"),60),repeat(2,action(fire(direction(-90,"aim"),speed(4),bulletRef("bit",110)),fire(direction(-90,"aim"),speed(2),bulletRef("bit",90)),fire(direction(90,"aim"),speed(2),bulletRef("bit",-90)),fire(direction(90,"aim"),speed(4),bulletRef("bit",-110)),wait(60)))),bit:bullet(action(wait(2),changeSpeed(0,1),fire(direction("$1","relative"),speed("2.1+$rank"),
bullet("g")),repeat("1+$rank*10",action(wait(1),fire(direction(0,"sequence"),speed(0,"sequence"),bullet("g")))),vanish()))})}
J.middle=K({top:action(wait(0),changeDirection(direction(0,"absolute"),1),changeSpeed(speed(0.8),1),wait(140),changeDirection(direction(0,"absolute"),60),repeat(2,action(fire(direction(-90,"aim"),speed(4),bulletRef("bit",60)),fire(direction(-90,"aim"),speed(2),bulletRef("bit",80)),fire(direction(90,"aim"),speed(2),bulletRef("bit",-80)),fire(direction(90,"aim"),speed(4),bulletRef("bit",-60)),wait(60)))),bit:bullet(action(wait(2),changeSpeed(0,1),fire(direction("$1","relative"),speed("2.5+$rank"),bullet("g")),
repeat("1+$rank*10",action(wait(1),fire(direction(0,"sequence"),speed(0,"sequence"),bullet("g")))),vanish()))});J.middle2L0=S(0,10);J.middle2L1=S(50,10);J.middle2L2=S(100,10);J.middle2L3=S(150,10);J.middle2L4=S(200,10);J.middle2R0=S(0,-10);J.middle2R1=S(50,-10);J.middle2R2=S(100,-10);J.middle2R3=S(150,-10);J.middle2R4=S(200,-10);
J.middleKR=K({top:action(changeDirection(direction(-90,"absolute"),1),changeSpeed(speed(4),1),wait(5),changeSpeed(speed(0),70),wait(70),changeDirection(direction(-70,"absolute"),1),changeSpeed(speed(0.1),1),repeat(3,action(repeat(5,action(fire(direction(-90,"absolute"),speed(1),bulletRef("bit",-1)),fire(direction(90,"absolute"),speed(1),bulletRef("bit",1)),wait(10))),actionRef("wshot",-84),actionRef("wshot",-36),actionRef("wshot",12),actionRef("wshot",60),wait(40),repeat(5,action(fire(direction(-90,
"absolute"),speed(1),bulletRef("bit",-1)),fire(direction(90,"absolute"),speed(1),bulletRef("bit",1)),wait(10))),actionRef("wshot",-60),actionRef("wshot",-12),actionRef("wshot",36),wait(40)))),bit:bullet(action(wait(5),changeDirection(direction(-70,"absolute"),1),changeSpeed(speed(0.1),1),fire(direction("-2*$1","absolute"),speed("0.001+$rank*0.01"),bulletRef("greenAccel")),repeat(90/7,action(wait(5),fire(direction("7*$1","sequence"),speed(0.1,"sequence"),bulletRef("greenAccel")))),vanish())),greenAccel:bullet(action(changeSpeed(speed("0.7+$rank",
"relative"),300))),wshot:action(fire(direction("$1"),speed("1.1+$rank"),bullet("b")),fire(direction(0,"sequence"),speed(-0.1,"sequence"),bullet("b")),fire(direction(0,"sequence"),speed(-0.1,"sequence"),bullet("b")),fire(direction(0,"sequence"),speed(-0.1,"sequence"),bullet("b")),repeat(3,action(fire(direction(8,"sequence"),speed(0.3,"sequence"),bullet("b")),fire(direction(0,"sequence"),speed(-0.1,"sequence"),bullet("b")),fire(direction(0,"sequence"),speed(-0.1,"sequence"),bullet("b")),fire(direction(0,
"sequence"),speed(-0.1,"sequence"),bullet("b")))))});
J.cannon=K({top1:action(wait(100),repeat(100,action(changeDirection(direction(180,"relative"),600),repeat(30,action(fire(direction(0,"relative"),speed("1.0+$rank"),bullet("g")),fire(direction(90,"sequence"),speed("1.0+$rank"),bullet("g")),fire(direction(90,"sequence"),speed("1.0+$rank"),bullet("g")),fire(direction(90,"sequence"),speed("1.0+$rank"),bullet("g")),wait(20)))))),top2:action(changeDirection(direction(0,"absolute"),1),changeSpeed(speed(0.2),1))});
J.cannon2=K({top1:action(wait(100),repeat(100,action(repeat(30,action(changeDirection(direction(90,"relative"),20),repeat(5,action(fire(direction(0,"relative"),speed("0.6+$rank"),bullet("g")),fire(direction(120,"sequence"),speed("0.6+$rank"),bullet("g")),fire(direction(120,"sequence"),speed("0.6+$rank"),bullet("g")),wait(2))),wait(30)))))),top2:action(changeDirection(direction(0,"absolute"),1),changeSpeed(speed(0.2),1))});
J.cannon3=K({top1:action(actionRef("attack",-1)),top2:action(actionRef("attack",1)),attack:action(changeDirection(direction(0,"absolute"),100),wait(100),repeat(100,action(changeDirection(direction("10*$1","relative"),100),repeat(100/30,action(fire(direction(0,"relative"),speed("0.5+$rank"),bullet("g")),fire(direction(90,"sequence"),speed(0,"sequence"),bullet("g")),fire(direction(90,"sequence"),speed(0,"sequence"),bullet("g")),fire(direction(90,"sequence"),speed(0,"sequence"),bullet("g")),wait(30)))))),
top3:action(changeDirection(direction(0,"absolute"),1),changeSpeed(speed(0.2),1))});
for(var $a=action(actionRef("launch"),repeat(900,action(actionRef("attack1"),actionRef("move2"),actionRef("attack2"),actionRef("move2"),actionRef("attack3"),actionRef("move2")))),ab=action(changeDirection(direction(0,"absolute"),1),changeSpeed(speed(2),1),wait(15),changeSpeed(speed(-0.5),140),wait(140),changeSpeed(speed(0),10)),eb=action(fire(direction(-125,"absolute"),speed(4),bulletRef("bit1",-1,30)),fire(direction(-125,"absolute"),speed(4),bulletRef("bit1",-1,-30)),fire(direction(125,"absolute"),
speed(4),bulletRef("bit1",1,30)),fire(direction(125,"absolute"),speed(4),bulletRef("bit1",1,-30)),wait(226),wait(30)),fb=bullet(action(wait(12),changeSpeed(0,1),fire(direction("$2"),speed("0.3+$rank"),bullet()),repeat(144,action(fire(direction("10*$1","sequence"),speed(0.02,"sequence"),bullet()),wait(2))),vanish())),gb=action(changeSpeed(speed(1),100),wait(60),changeSpeed(speed(-1),100),wait(66),changeSpeed(speed(0),100),wait(100)),hb=action,ib=[],T=0;8>T;T++)ib.push(fire(direction(-125,"absolute"),
speed(4),bulletRef("bit2",10*T,0.1*T))),ib.push(wait(60-5*T)),ib.push(fire(direction(125,"absolute"),speed(4),bulletRef("bit2",-10*T,0.1*T))),ib.push(wait(60-5*T));
J.boss11=K({top:$a,launch:ab,attack1:eb,bit1:fb,move2:gb,attack2:hb(ib),bit2:bullet(action(wait(12),changeSpeed(0,1),repeat(3,action(actionRef("fire1","$1+-80","$2"),actionRef("fire1","$1+-40","$2"),actionRef("fire1","$1+  0","$2"),actionRef("fire1","$1+ 40","$2"),actionRef("fire1","$1+ 80","$2"),wait(5))),vanish())),fire1:action(fire(direction("$1-10","absolute"),speed("1+$rank+$2"),bullet()),repeat(4,action(fire(direction(5,"sequence"),speed(0,"sequence"),bullet())))),attack3:action(fire(direction(-125,
"absolute"),speed(4),bulletRef("bit3",0)),fire(direction(125,"absolute"),speed(4),bulletRef("bit3","160*(1.1-$rank)/2")),repeat(25,action(fire(direction(0,"aim"),speed("0.8+$rank"),bullet("g")),fire(direction(0,"sequence"),speed("0.9+$rank"),bullet("g")),repeat("360/(40*(1.1-$rank))-1",action(fire(direction("40*(1.1-$rank)","sequence"),speed("0.8+$rank"),bullet("g")),fire(direction(0,"sequence"),speed("0.9+$rank"),bullet("g")))),wait(40)))),bit3:bullet(action(wait(12),changeSpeed(speed(0),1),wait("$1"),
repeat("6/(1.1-$rank)",action(fire(direction("$rand*30-15"),bullet()),fire(direction("$rand*30-15"),bullet()),fire(direction("$rand*30-15"),bullet()),wait("160*(1.1-$rank)"))),vanish()))});
var jb=action(changeDirection(direction(0,"absolute"),1),actionRef("move"),repeat(300,action(actionRef("attack4"),actionRef("move"),actionRef("attack1"),actionRef("move"),actionRef("attack2"),actionRef("move")))),kb=action(changeSpeed(speed(1),100),wait(60),changeSpeed(speed(-1),100),wait(64),changeSpeed(speed(0),100),wait(100)),lb=action(fire(speed(0),bulletRef("bit10")),fire(speed(0),bulletRef("bit12")),wait(1500)),mb=bullet(action(repeat(120,action(fire(direction(-90,"absolute"),speed(5),bulletRef("bit11")),
fire(direction(-45,"absolute"),speed(2.7),bulletRef("bit11")),fire(direction(45,"absolute"),speed(2.7),bulletRef("bit11")),fire(direction(90,"absolute"),speed(5),bulletRef("bit11")),wait(10))),vanish())),nb=bullet(action(wait(12),changeSpeed(speed(0),1),fire(direction("$rand*10-5+ -150"),speed("1.8*$rank"),bullet()),fire(direction("$rand*10-5+  -90"),speed("1.8*$rank"),bullet()),fire(direction("$rand*10-5+  -30"),speed("1.8*$rank"),bullet()),fire(direction("$rand*10-5+   30"),speed("1.8*$rank"),bullet()),
fire(direction("$rand*10-5+   90"),speed("1.8*$rank"),bullet()),fire(direction("$rand*10-5+  150"),speed("1.8*$rank"),bullet()),vanish())),ob=bullet,pb=action,V=[];V.push(fire(direction(-125,"absolute"),speed(4),bulletRef("bit13",1)));V.push(wait(120));V.push(fire(direction(125,"absolute"),speed(4),bulletRef("bit13",1)));V.push(wait(120));
for(var qb=100;5<qb;qb-=10)V.push(fire(direction(-125,"absolute"),speed(4),bulletRef("bit13",2))),V.push(wait(qb+5)),V.push(fire(direction(125,"absolute"),speed(4),bulletRef("bit13",2))),V.push(wait(qb));for(qb=0;5>qb;qb++)V.push(fire(direction(-125,"absolute"),speed(4),bulletRef("bit13",2))),V.push(wait(5)),V.push(fire(direction(125,"absolute"),speed(4),bulletRef("bit13",2))),V.push(wait(5));V.push(vanish());
var rb=ob(pb(V)),sb=bullet(action(wait(12),changeSpeed(speed(0),1),fire(direction("$rand*4-2"),speed("4*$rank+$1"),bullet("g")),repeat(20,action(wait(1),fire(direction(0,"sequence"),speed(0.3,"sequence"),bullet("g")))),vanish())),tb=action(fire(direction(-90,"absolute"),speed(5),bulletRef("bit21",1)),fire(direction(-125,"absolute"),speed(4),bulletRef("bit20",-1)),fire(direction(125,"absolute"),speed(4),bulletRef("bit20",1)),fire(direction(90,"absolute"),speed(5),bulletRef("bit21",-1)),wait(800)),
ub=bullet(action(wait(12),changeSpeed(speed(0),1),repeat(4,action(changeDirection(direction("70*$1","relative"),"60+$rank*40"),repeat(70/9,action(fire(direction(0,"relative"),speed("0.8+$rank"),bullet()),fire(direction(90,"relative"),speed("0.8+$rank"),bullet()),fire(direction(180,"relative"),speed("0.8+$rank"),bullet()),fire(direction(270,"relative"),speed("0.8+$rank"),bullet()),wait(9))),changeDirection(direction("-70*$1","relative"),"60+$rank*40"),repeat(70/9,action(fire(direction(0,"relative"),
speed("0.8+$rank"),bullet()),fire(direction(90,"relative"),speed("0.8+$rank"),bullet()),fire(direction(180,"relative"),speed("0.8+$rank"),bullet()),fire(direction(270,"relative"),speed("0.8+$rank"),bullet()),wait(9))))),vanish())),vb=bullet,wb=action,xb=[];xb.push(wait(12));xb.push(changeSpeed(speed(0),1));
for(var yb=-35;-10>yb;yb++){xb.push(fire(direction(yb+"*$1","aim"),speed("2.4+$rank"),bullet("g")));for(var zb=0;3>zb;zb++)xb.push(wait(1)),xb.push(fire(direction(0,"sequence"),speed(0,"sequence"),bullet("g")));xb.push(wait(15))}xb.push(vanish());
J.boss12=K({top:jb,move:kb,attack1:lb,bit10:mb,bit11:nb,bit12:rb,bit13:sb,attack2:tb,bit20:ub,bit21:vb(wb(xb)),attack4:action(fire(direction(-125,"absolute"),speed(4),bulletRef("bit4",-1,180)),fire(direction(-125,"absolute"),speed(4),bulletRef("bit4",-1,150)),fire(direction(-125,"absolute"),speed(4),bulletRef("bit4",-1,120)),fire(direction(-125,"absolute"),speed(4),bulletRef("bit4",-1,90)),fire(direction(125,"absolute"),speed(4),bulletRef("bit4",1,90)),fire(direction(125,"absolute"),speed(4),bulletRef("bit4",
1,120)),fire(direction(125,"absolute"),speed(4),bulletRef("bit4",1,150)),fire(direction(125,"absolute"),speed(4),bulletRef("bit4",1,180)),repeat(15,action(fire(direction(-125,"absolute"),speed(4),bulletRef("bit42")),wait(20),fire(direction(125,"absolute"),speed(4),bulletRef("bit42")),wait(20)))),bit4:bullet(action(wait(12),changeSpeed(speed(0),1),changeDirection(direction("$2*$1","absolute"),1),wait(5),changeDirection(direction("($2-100)*$1","absolute"),600),repeat(150,action(fire(direction(0,"relative"),
speed(5),bullet("g")),wait(4))),vanish())),bit42:bullet(action(wait(12),changeSpeed(speed(0),1),fire(direction("$rand*10-2"),speed("0.8+$rank"),bullet()),fire(direction(1,"sequence"),speed(0,"sequence"),bullet()),fire(direction(1,"sequence"),speed(0,"sequence"),bullet()),vanish()))});
for(var Ab=action(actionRef("initPosition"),repeat(100,action(actionRef("attack2"),actionRef("attack3"),actionRef("attack4")))),Bb=action(changeDirection(direction(158,"absolute"),1),changeSpeed(speed(0.6),1),wait(5),fire(direction(0,"relative"),speed(0.6),bulletRef("bit11")),fire(direction(0,"relative"),speed(0.6),bulletRef("bit13")),wait(500),changeSpeed(speed(0),60),wait(60),changeDirection(direction(0,"absolute"),1),wait(120)),Cb=bullet(action(wait(120),actionRef("bit11Action",30,2,100),actionRef("bit11Action",
10,2,100),repeat(4,action(actionRef("bit11Action","-60+$rand*90",0.8,80))),repeat(2,action(actionRef("bit11Action","-60+$rand*90",0,80),actionRef("bit11Action","-60+$rand*90",0.8,80))),vanish())),Db=action(fire(direction(0,"absolute"),bulletRef("bit12","$1","$3")),repeat(23,action(fire(direction(15,"sequence"),bulletRef("bit12","$1","$3")))),wait("45*$2")),Eb=bullet(action(wait("10+$rank*20"),fire(direction("155+$1","absolute"),speed("1.2+$rank"),bulletRef("blueC","$2")),vanish())),Fb=bullet(action(wait("$1"),
fire(direction(0),speed("2+$rank"),bullet("r")),vanish())),Gb=bullet(action(wait(120),repeat(500/57,action(fire(direction(-25),speed("1.5+$rank"),bullet("g")),repeat(5,action(fire(direction(-2,"sequence"),speed(0,"sequence"),bullet("g")))),repeat(5,action(fire(direction(-50,"sequence"),speed("1.5+$rank"),bullet("g")),repeat(5,action(fire(direction(-2,"sequence"),speed(0,"sequence"),bullet("g")))))),wait(57))),vanish())),Hb=action(fire(speed(0),bulletRef("bit21")),fire(speed(0),bulletRef("bit22")),
wait(900)),Ib=bullet(action(repeat(8,action(fire(direction(-65),speed("1.8+$rank"),bullet("g")),repeat("6+$rank*8",action(fire(direction("30/(6+$rank*8)","sequence"),speed(0,"sequence"),bullet("g")))),fire(direction(-15),speed("1.8+$rank"),bullet("g")),repeat("6+$rank*8",action(fire(direction("30/(6+$rank*8)","sequence"),speed(0,"sequence"),bullet("g")))),fire(direction(35),speed("1.8+$rank"),bullet("g")),repeat("6+$rank*8",action(fire(direction("30/(6+$rank*8)","sequence"),speed(0,"sequence"),bullet("g")))),
wait(65),fire(direction(-90),speed("1.8+$rank"),bullet("g")),repeat("6+$rank*8",action(fire(direction("30/(6+$rank*8)","sequence"),speed(0,"sequence"),bullet("g")))),fire(direction(-40),speed("1.8+$rank"),bullet("g")),repeat("6+$rank*8",action(fire(direction("30/(6+$rank*8)","sequence"),speed(0,"sequence"),bullet("g")))),fire(direction(10),speed("1.8+$rank"),bullet("g")),repeat("6+$rank*8",action(fire(direction("30/(6+$rank*8)","sequence"),speed(0,"sequence"),bullet("g")))),fire(direction(60),speed("1.8+$rank"),
bullet("g")),repeat("6+$rank*8",action(fire(direction("30/(6+$rank*8)","sequence"),speed(0,"sequence"),bullet("g")))),wait(65))),vanish())),Jb=bullet(action(wait(20),fire(direction(-90,"absolute"),speed(2),bulletRef("bit221")),wait(60),fire(direction(90,"absolute"),speed(2),bulletRef("bit221")),vanish())),Kb=bullet(action(wait(30),changeSpeed(speed(0),1),repeat(8,action(fire(direction(-60),speed(0),bulletRef("bullet22",0,"2.2+$rank")),fire(direction(0,"sequence"),speed(0),bulletRef("bullet22",5,"2.2+$rank")),
fire(direction(0,"sequence"),speed(0),bulletRef("bullet22",10,"2.2+$rank")),fire(direction(0,"sequence"),speed(0),bulletRef("bullet22",15,"2.2+$rank")),fire(direction(0,"sequence"),speed(0),bulletRef("bullet22",20,"2.2+$rank")),fire(direction(0,"sequence"),speed(0),bulletRef("bullet22",25,"2.2+$rank")),repeat("(6+$rank*4)",action(fire(direction("120/(6+$rank*4)","sequence"),speed(0),bulletRef("bullet22",0,"2.2+$rank")),fire(direction(0,"sequence"),speed(0),bulletRef("bullet22",5,"2.2+$rank")),fire(direction(0,
"sequence"),speed(0),bulletRef("bullet22",10,"2.2+$rank")),fire(direction(0,"sequence"),speed(0),bulletRef("bullet22",15,"2.2+$rank")),fire(direction(0,"sequence"),speed(0),bulletRef("bullet22",20,"2.2+$rank")),fire(direction(0,"sequence"),speed(0),bulletRef("bullet22",25,"2.2+$rank")))),wait(117))),vanish())),Lb=bullet(action(wait("$1"),changeSpeed(speed("$1*0.05+$2"),1))),Mb=action,W=[],X=0;30>X;X++)W[W.length]=fire(direction("-45-$rand*120","absolute"),speed("1.5+$rand*6"),bulletRef("blue3alive",
0.5*X)),W[W.length]=wait(2),W[W.length]=fire(direction(" 45+$rand*120","absolute"),speed("1.5+$rand*6"),bulletRef("blue3alive",0.5*X)),W[W.length]=wait(2);W[W.length]=wait(120);for(X=0;30>X;X++)W[W.length]=fire(direction("-45-$rand*120","absolute"),speed("1.5+$rand*6"),bulletRef("blue3alive",-0.5*X)),W[W.length]=wait(2),W[W.length]=fire(direction(" 45+$rand*120","absolute"),speed("1.5+$rand*6"),bulletRef("blue3alive",-0.5*X)),W[W.length]=wait(2);W[W.length]=wait(220);
J.boss21=K({top:Ab,initPosition:Bb,bit11:Cb,bit11Action:Db,bit12:Eb,blueC:Fb,bit13:Gb,attack2:Hb,bit21:Ib,bit22:Jb,bit221:Kb,bullet22:Lb,attack3:Mb(W),blue3alive:bullet(action(wait("10+$rand*5"),changeSpeed(speed(0),20),wait(180),fire(direction("$1-2","absolute"),speed("4.5+$rank"),bullet("b")),fire(direction("$1+2","absolute"),speed("4.5+$rank"),bullet("b")),fire(direction("$1-1","absolute"),speed("4.5+$rank"),bullet("b")),fire(direction("$1+1","absolute"),speed("4.5+$rank"),bullet("b")),fire(direction("$1",
"absolute"),speed("4+$rank"),bullet("b")),repeat(10,action(fire(direction(0,"sequence"),speed(0.2,"sequence"),bullet("b")))),vanish())),attack4:action(repeat(4,action(fire(direction(-125,"absolute"),speed(4),bulletRef("bit40",-1)),fire(direction(125,"absolute"),speed(4),bulletRef("bit40",1)),wait(170))),wait(100)),bit40:bullet(action(wait(12),changeSpeed(speed(0),1),changeDirection(direction("170*$1+$rand*10","relative"),"60+$rank*50"),repeat(14,action(fire(direction(0,"relative"),speed("1.2+$rank"),
bullet()),fire(direction(90,"relative"),speed("1.2+$rank"),bullet()),fire(direction(180,"relative"),speed("1.2+$rank"),bullet()),fire(direction(270,"relative"),speed("1.2+$rank"),bullet()),wait(5))),repeat(2,action(fire(direction("$rand*40-20"),speed("1.2+$rank"),bullet("g")),repeat(10,action(repeat(7,action(fire(direction(360/7,"sequence"),speed(0,"sequence"),bullet("g")))),wait(1))))),changeDirection(direction("-170*$1","relative"),"60+$rank*50"),repeat(14,action(fire(direction(0,"relative"),speed("1.2+$rank"),
bullet()),fire(direction(90,"relative"),speed("1.2+$rank"),bullet()),fire(direction(180,"relative"),speed("1.2+$rank"),bullet()),fire(direction(270,"relative"),speed("1.2+$rank"),bullet()),wait(5))),repeat(2,action(fire(direction("$rand*40-20"),speed("1.2+$rank"),bullet("g")),repeat(10,action(repeat(7,action(fire(direction(360/7,"sequence"),speed(0,"sequence"),bullet("g")))),wait(1))))),vanish()))});
var Nb=action(wait(60),repeat(100,action(actionRef("attack1"),actionRef("attack2")))),Ob=action,Y=[];Y[Y.length]=changeDirection(direction(90,"absolute"),1);Y[Y.length]=changeSpeed(speed(2),40);Y[Y.length]=wait(20);Y[Y.length]=changeSpeed(speed(0),40);Y[Y.length]=wait(20);
for(var Pb=0;6>Pb;Pb++)Y[Y.length]=fire(direction(-115,"absolute"),speed(10),bulletRef("bit1",0,-1,Pb)),Y[Y.length]=fire(direction(115,"absolute"),speed(10),bulletRef("bit1",0,1,Pb)),Y[Y.length]=wait(40),"a"[Y.length]=changeSpeed(speed(Pb%2?2:-2),80),Y[Y.length]=wait(40),Y[Y.length]=changeSpeed(speed(0),80),Y[Y.length]=wait(40);Y[Y.length]=fire(direction(-115,"absolute"),speed(10),bulletRef("bit1",0,-1,Pb));Y[Y.length]=fire(direction(115,"absolute"),speed(10),bulletRef("bit1",0,1,Pb));
Y[Y.length]=wait(40);Y[Y.length]=changeSpeed(speed(Pb%2?2:-2),40);Y[Y.length]=wait(20);Y[Y.length]=changeSpeed(speed(0),40);Y[Y.length]=wait(60);
for(var Qb=Ob(Y),Rb=bullet(action(wait(5),changeSpeed(speed(0),1),wait("5+$1"),fire(direction("-120*$2"),speed("1.0+$rank+$3*0.2"),bullet()),repeat("240 / (24-$rank*12)",action(fire(direction(30,"sequence"),speed(0,"sequence"),bullet()),fire(direction("-30 + (24-$rank*12)*$2","sequence"),speed(0,"sequence"),bullet()),wait(1))),fire(direction("+120*$2"),speed(0,"sequence"),bullet()),repeat("240 / (24-$rank*12)",action(fire(direction(30,"sequence"),speed(0,"sequence"),bullet()),fire(direction("-30 + -(24-$rank*12)*$2",
"sequence"),speed(0,"sequence"),bullet()),wait(1))),vanish())),Sb=action(fire(direction(0),speed(0),bulletRef("bithori")),fire(direction(0),speed(0),bulletRef("bitvert")),wait(1220)),Tb=bullet,Ub=action,Z=[],$=-15;15>$;$+=3)Z[Z.length]=actionRef("fireBigBulletR",-80+$),Z[Z.length]=actionRef("fireBigBulletR",-40+$),Z[Z.length]=actionRef("fireBigBulletR",0+$),Z[Z.length]=actionRef("fireBigBulletR",40+$),Z[Z.length]=actionRef("fireBigBulletR",80+$),Z[Z.length]=wait(50),Z[Z.length]=actionRef("fireBigBulletR",
-100+$),Z[Z.length]=actionRef("fireBigBulletR",-60+$),Z[Z.length]=actionRef("fireBigBulletR",-20+$),Z[Z.length]=actionRef("fireBigBulletR",20+$),Z[Z.length]=actionRef("fireBigBulletR",60+$),Z[Z.length]=actionRef("fireBigBulletR",100+$),Z[Z.length]=wait(50);Z[Z.length]=vanish();
J.boss22=K({top:Nb,attack1:Qb,oc:Rb,nc:Sb,qc:Tb(Ub(Z)),pc:bullet(action(actionRef("fireBlueBit",33),actionRef("fireBlueBit",44),actionRef("fireBlueBit",55),actionRef("fireBlueBit",66),actionRef("fireBlueBit",77),actionRef("fireBlueBit",88),vanish())),xc:action(repeat(3,action(fire(direction(-90,"absolute"),speed(8),bulletRef("blueBitalive","$1")),fire(direction(90,"absolute"),speed(8),bulletRef("blueBitalive","$1")),wait(40)))),sc:bullet(action(wait(5),changeSpeed(speed(0),25),wait(30),changeDirection(direction(0,
"absolute"),1),changeSpeed(speed(1.5),10),repeat(999,action(wait("$1"),actionRef("fireBigBulletG",-90),actionRef("fireBigBulletB",90))))),wc:action(fire(direction("$rand*90","absolute"),speed(1),bulletRef("redBB","$1")),repeat(11,action(fire(direction(30,"sequence"),speed(0,"sequence"),bulletRef("redBB","$1"))))),Bc:bullet(action(wait(10),fire(direction("$1","absolute"),speed("3*$rank"),bullet()),vanish())),vc:action(fire(direction("$rand*90","absolute"),speed(1),bulletRef("greenBB","$1")),repeat(11,
action(fire(direction(30,"sequence"),speed(0,"sequence"),bulletRef("greenBB","$1"))))),zc:bullet(action(wait(10),fire(direction("$1","absolute"),speed("3*$rank"),bullet("g")),vanish())),uc:action(fire(direction("$rand*90","absolute"),speed(1),bulletRef("blueBB","$1")),repeat(11,action(fire(direction(30,"sequence"),speed(0,"sequence"),bulletRef("blueBB","$1"))))),rc:bullet(action(wait(10),fire(direction("$1","absolute"),speed("3*$rank"),bullet("b")),vanish()))});var Vb={zako:{ka:20,ha:5,scale:1,score:100},zakoS:{ka:20,ha:5,scale:1,score:50},tank:{ka:21,ha:5,scale:1,score:100},bigger:{ka:23,ha:200,scale:4,score:1E3},middle:{ka:22,ha:50,scale:2,score:800},middleK:{ka:22,ha:500,scale:4,score:1E3,clear:m},cannon:{ka:20,ha:50,scale:2,score:400},cannon2:{ka:20,ha:150,scale:3.5,score:400,clear:m},ship:{ka:24,ha:10,scale:1.5,score:200},boss:{ka:0,ha:16E3,scale:8,score:0}};var G=q,Wb=0.2*0.2;
tm.preload(function(){tm.util.FileManager.load("vs",{url:"shaders/shader.vs",type:"GET"});tm.util.FileManager.load("fs",{url:"shaders/shader.fs",type:"GET"});tm.graphics.TextureManager.add("texture0","images/texture0.png");tm.graphics.TextureManager.add("boss1","images/boss1.png");tm.graphics.TextureManager.add("boss2","images/boss2.png");tm.graphics.TextureManager.add("boss3","images/boss3.png");tm.sound.SoundManager.add("bgm1","http://static.dev7.jp/glshooter/sounds/nc28689.mp3",1);tm.sound.SoundManager.add("bgm2",
"http://static.dev7.jp/glshooter/sounds/nc784.mp3",1);tm.sound.SoundManager.add("bgm3","http://static.dev7.jp/glshooter/sounds/nc790.mp3",1);tm.sound.SoundManager.add("explode","sounds/se_maoudamashii_explosion05.mp3",20);tm.sound.SoundManager.add("effect0","sounds/effect0.mp3",1);tm.sound.SoundManager.add("bomb","sounds/nc17909.mp3");tm.sound.SoundManager.add("v-genBomb","sounds/voice_gen-bomb.mp3",1);tm.sound.SoundManager.add("v-extend","sounds/voice_extend.mp3",1)});
tm.main(function(){function a(){var a=new F(M);a.alpha=0.5;a.na=1;a.ya=function(){this.update=aa();ua.push(this)};a.ma=function(a){this.ha-=a;0<this.ha||(l.remove(this),this.ec())};a.ec=function(){this.Oa!==k&&(va[this.Oa]=m);this.clear===m&&na(q);var a=(r.x-this.x)*(r.x-this.x)+(r.y-this.y)*(r.y-this.y)-(r.scale+this.scale),a=Math.clamp(a,0,25),a=Math.max(1,4*((25-a)/25));b.Ba(this.score*a*a,m);if(this.clear!==m)wa(this.x,this.y,this.scale),0<fa||(G||f.get("explode").play(),fa=5);else{a=new F(M);
a.da=7;a.ga=7;a.x=this.x;a.y=this.y;var c=l.frame;a.update=function(){na(q);0===l.frame%5&&0.7>Math.random()?(0>=fa&&(G||f.get("explode").play(),fa=5),wa(this.x+6*Math.random()-3,this.y+6*Math.random()-3,2)):l.frame>c+60&&l.remove(this)};l.add(a)}};return a}function c(){var a=new F(M);a.da=4;a.ga=1;a.radius=0;a.za=-0.01;a.ja=0;a.update=function(){this.x=Math.cos(this.ja)*this.radius;this.y=Math.sin(this.ja)*this.radius;this.ja+=0.01;this.radius+=this.za;this.za-=0.0020;this.scale=0.6*(17-this.radius);
this.alpha=0.1*(28-this.scale);0>this.alpha&&(l.remove(this),D.Ea+=1)};return a}function d(a,b,c){var d=xa.pop();if(d!==k){d.rotation=c;var f=Math.sin((90-c)*Math.DEG_TO_RAD),g=Math.cos((90-c)*Math.DEG_TO_RAD);d.update=function(){this.x+=1.3*g;this.y+=1.3*f;(-16.2>this.x||16.2<this.x||-16.2>this.y||16.2<this.y)&&l.remove(this)};d.x=z.x+a;d.y=z.y+b;l.add(d)}}var f=tm.sound.SoundManager;localStorage.getItem("jp.dev7.glshooter.settings")||localStorage.setItem("jp.dev7.glshooter.settings",JSON.stringify({ba:1,
ia:0.8}));var g=JSON.parse(localStorage.getItem("jp.dev7.glshooter.settings")),b=tm.app.CanvasApp("#tm");b.resize(320,320);b.fitWindow(q);b.background="rgba(0,0,0,1)";b.fps=60;b.va=0;b.pa=0;b.score=0;b.Ba=function(a,c){var d=~~(b.score/6E5),g=~~(b.score/1E6);this.score+=a*(c?Ea:1);0<a&&(d!==~~(b.score/6E5)&&(b.la+=1,G||f.get("v-genBomb").play()),g!==~~(b.score/1E6)&&(b.qa+=1,G||f.get("v-extend").play()))};b.Sa=function(){b.score=0;b.qa=3;b.la=3;r&&(r.ca=0)};b.ba=p;b.Fb=g.ba;b.Gb=g.ia;b.Sa();b.wa=
1;(b.hc=function(){["bgm1","bgm2","bgm3"].forEach(function(a){for(var c=f.sounds[a].length;c--;)f.sounds[a][c].volume=b.Fb});["explode","effect0","bomb","v-genBomb","v-extend"].forEach(function(a){for(var c=f.sounds[a].length;c--;)f.sounds[a][c].volume=b.Gb})})();var n=b.$b=tm.app.Scene(),g=document.getElementById("world");g.style.position="absolute";g.style.top=0;g.style.left=0;window.innerHeight<window.innerWidth?(g.width=window.innerHeight,g.height=window.innerHeight):(g.width=window.innerWidth,
g.height=window.innerWidth);var v=b.keyboard,H=b.pointing=b.mouse=tm.input.Mouse(g);H.tb=-1;var E=b.Cc=Ra();b.ib=Sa();b.Bb=Ua(b);b.ob=Ta();var Ga=b.tc=Wa(),L=b.yc=Va();b.replaceScene(E);var E=tm.util.FileManager.get("vs").data,sa=tm.util.FileManager.get("fs").data,l=new A(g,E,sa),g=l.Pa,Ha={},j;for(j in tm.graphics.TextureManager.textures){var E=Ha,sa=j,B=g,Ka=tm.graphics.TextureManager.get(j).element,Fa=B.createTexture();B.bindTexture(B.TEXTURE_2D,Fa);B.texImage2D(B.TEXTURE_2D,0,B.RGBA,B.RGBA,B.UNSIGNED_BYTE,
Ka);B.generateMipmap(B.TEXTURE_2D);B.bindTexture(B.TEXTURE_2D,p);E[sa]=Fa}var M=F.wb=Ha.texture0,oa=new Da(l,M),wa=b.Na=oa.Na,La=b.qb=oa.qb;oa.rb(g);b.Rb=oa.$a;var ga=[],z=new F(M);z.scale=1.5;z.ca=0;z.reset=function(){this.x=0;this.y=-10;this.da=3;this.ea=this.na=0;this.speed=0.2;this.disabled=this.sa=q;this.yb=1;this.Ca=q};var U=b.keyboard,ya=0;z.update=function(){this.visible=this.disabled||this.Ca?0===~~(l.frame/2)%2:m;this.sa&&(this.y+=0.1,-10<this.y&&(this.disabled=this.sa=q,this.visible=m,
ya=l.frame));this.Ca=l.frame<ya+90;for(var a=0.25*(1-Math.abs(this.ea/3))+0.2,b=this.sa?8:2,c=0;c<b;c++){var f=ha.pop();f&&(f.x=this.x+0.1*Math.random()-0.05-a,f.y=this.y-1.2,f.alpha=0.8,f.scale=0.6,l.add(f));if(f=ha.pop())f.x=this.x+0.1*Math.random()-0.05+a,f.y=this.y-1.2,f.alpha=0.8,f.scale=0.6,l.add(f)}a=this.ea;if(!this.disabled){var g=U.getKey("x");this.speed=g?0.1:0.2;U.getKey("left")?(this.x-=this.speed,this.ea-=0.2):U.getKey("right")&&(this.x+=this.speed,this.ea+=0.2);U.getKey("down")?this.y-=
this.speed:U.getKey("up")&&(this.y+=this.speed);H.getPointing()&&(g=q,b=H.deltaPosition.x,this.x+=0.1*b,this.y+=-0.1*H.deltaPosition.y,0>b?this.ea-=0.5:0<b&&(this.ea+=0.5));-16>this.x&&(this.x=-16);16<this.x&&(this.x=16);-16>this.y&&(this.y=-16);16<this.y&&(this.y=16)}a===this.ea&&(this.ea*=0.95);-3>this.ea?this.ea=-3:3<this.ea&&(this.ea=3);this.da=3+~~this.ea;!this.disabled&&(0===l.frame%3&&!U.getKey("c"))&&(g&&(2>this.ca||d(-0.19,1.2,0),2>this.ca||d(-0.18,1.3,0),1>this.ca||d(-0.17,1.4,0),1>this.ca||
d(-0.16,1.5,0),d(-0.15,1.6,0),d(-0.1,1.7,0),d(-0.05,1.8,0),d(0,1.9,0),d(0.05,1.8,0),d(0.1,1.7,0),d(0.15,1.6,0),1>this.ca||d(0.16,1.5,0),1>this.ca||d(0.17,1.4,0),2>this.ca||d(0.18,1.3,0),2>this.ca||d(0.19,1.2,0)),2>this.ca||d(0.75*-Math.sin(0.1*l.frame),1.4,0),1>this.ca||d(0.5*-Math.sin(0.1*l.frame),1.4,0),d(0.25*+Math.sin(0.1*l.frame),1.4,0),d(0.25*-Math.sin(0.1*l.frame),1.4,0),1>this.ca||d(0.5*+Math.sin(0.1*l.frame),1.4,0),2>this.ca||d(0.75*+Math.sin(0.1*l.frame),1.4,0),a=g?0:4,1>this.ca||d(1.5,
0,3*a),d(1,0,2*a),2>this.ca||d(0.5,0,1*a),2>this.ca||d(-0.5,0,-1*a),d(-1,0,-2*a),1>this.ca||d(-1.5,0,-3*a),this.yb=g?0.6:1)};z.ma=function(){this.dc()};z.dc=function(){b.Na(this.x,this.y,2);var a=tm.sound.SoundManager.get("explode");a!==k&&(G||a.play());b.qa-=1;0===b.qa?(l.remove(this),this.sa=this.visible=q,b.Vb()):z.vb()};z.vb=function(){b.la=Math.max(3,b.la);2!==this.ca&&(this.ca+=1);this.x=0;this.y=-17;this.Ca=this.sa=this.disabled=this.visible=m;this.ea=0;this.da=3};l.add(z);j=new F(M);j.x=z.x;
j.y=z.y;j.da=2;j.ga=1;j.scale=0.5;j.update=function(){this.x=z.x;this.y=z.y;this.visible=z.visible&&z.parent!==p;this.scale=0.3+0.2*Math.sin(0.2*l.frame)};l.add(j);var za=[],ha=[];for(j=0;200>j;j++)g=new F(M),g.da=4,g.ga=1,g.update=function(){this.visible=z.visible;this.y-=0.2;this.scale-=0.08;this.alpha-=0.08;0>this.alpha&&l.remove(this)},g.ya=function(){ha.push(this)},za.push(g),ha.push(g);var xa=[];for(j=0;400>j;j++)g=new F(M),g.da=7,g.ga=1,ga.push(g),xa.push(g),g.ya=function(){xa.push(this)};
z.$a=function(){for(var a=za.length;a--;)za[a].alpha=0;for(a=ga.length;a--;)ga[a].y=100};var r=b.xb=z;b.Sb=r.$a;var P=0,Ea=1,D=[];for(j=0;50>j;j++)D.push(c());D.Ea=D.length;b.Xb=function(){D.Ea=0;for(var a=D.length;a--;){var b=D[a];b.radius=tm.util.Random.randfloat(16,22);b.ja=2*a%12*Math.PI/12-0.3*b.radius;b.za=-0.01;b.alpha=1;l.add(b)}G||tm.sound.SoundManager.get("bomb").play()};b.Tb=function(){for(var a=D.length;a--;)l.remove(D[a]);D.Ea=D.length};var ia=[],Aa=[];for(j=0;2E3>j;j++)g=new F(M),g.da=
3,g.ga=1,g.scale=0.6,g.Ac=m,ia.push(g),Aa.push(g),g.ya=function(){Aa.push(this)};attackParam=b.Ob={target:r,Ab:0.5,Pb:function(a){var b=Aa.pop();if(b!==k)return b.Wa=q,b.scale=0.6,a.label===p||a.label===k?(b.da=3,b.ga=1):"g"===a.label||0===a.label.indexOf("green")?(b.da=2,b.ga=1):"b"===a.label||0===a.label.indexOf("blue")?(b.da=1,b.ga=1):-1!==a.label.indexOf("bit")?(b.Wa=m,b.da=7,b.ga=7):(b.da=3,b.ga=1),a.label&&-1!==a.label.indexOf("alive")&&(b.Wa=m),"s"===a.label?b.scale=0.4:"sg"===a.label?(b.scale=
0.4,b.da=2,b.ga=1):"sb"===a.label&&(b.scale=0.4,b.da=1,b.ga=1),b},bc:function(a){return-22<a.x&&22>a.x&&-22<a.y&&22>a.y},mc:q,Ta:0.1};var na=b.ab=function(a){for(var b=ia.length;b--;){var c=ia[b];if(c.parent!==p&&(!c.Wa||a))wa(c.x,c.y,0.2),l.remove(c)}},va={},Q=[],ua=[],fa=-1;for(j=0;1E3>j;j++)g=a(),Q.push(g),ua.push(g);b.Qb=function(){for(var a=Q.length;a--;){var b=Q[a];b.parent!==p&&l.remove(b)}};j=Ia(r);n.addChild(j);j=Ja(r);n.addChild(j);j=Ma();n.addChild(j);var s=b.message=Na();j=Oa();n.addChild(j);
j=Pa();n.addChild(j);var bb,pa=q,ja=0;n.update=function(){v.getKeyDown("space")&&!r.disabled&&b.pushScene(b.ib);pa=q;fa--;var c=cb.next(l.frame,va);if(c!==k){for(var d=c.aa,f=d.length;f--;){var g=d[f],j=g[0],s=g[1],z=g[2],E=g[3],g=g[4],N=Vb[z],t=k;"boss"===z?(t=da,t.alpha=0.5,t.Ma=0,t.na=0.4,n.addChild(bb)):(t=ua.pop(),t===k&&(t=a(),Q.push(t)),t.da=N.ka%8,t.ga=~~(N.ka/8));t.x=j;t.y=s;t.ha=N.ha;t.scale=N.scale;t.score=N.score;t.clear=N.clear;va[g]=q;t.Oa=g;t.update=J[E].eb(attackParam);l.add(t)}f=
c.message;f!==k&&(g=b.message,g.text=f.text,g.fillStyle=f.color,f.visible?n.addChild(g):g.remove())}c=D.Ea!==D.length;(r.sa||c)&&na(q);if((v.getKeyDown("z")||H.pb)&&r.parent!==p&&0<b.la&&c===q){b.la-=1;for(f=Q.length;f--;)g=Q[f],g.parent!==p&&g.ma(20);na(q);b.Xb()}if(c===m)for(f=Q.length;f--;)g=Q[f],g.parent!==p&&g.ma(1);d=r.x;j=r.y;if(r.parent!==p&&!r.Ca&&!c&&!r.disabled)for(f=ia.length;f--;)if(g=ia[f],g.parent!==p)if(s=(g.x-d)*(g.x-d)+(g.y-j)*(g.y-j),s<Wb){l.remove(g);r.ma();P=0;break}else 1.5>
s&&b.Ba(1,m);if(r.parent!==p&&!r.Ca&&!c&&!r.disabled)for(f=Q.length;f--;)g=Q[f],g.parent!==p&&(s=(g.x-d)*(g.x-d)+(g.y-j)*(g.y-j),s<g.scale&&(r.ma(),P=0));for(f=ga.length;f--;)if(c=ga[f],c.parent!==p)for(d=Q.length;d--;)g=Q[d],g.parent!==p&&(j=c.x-g.x,s=c.y-g.y,j*j+s*s<2*g.scale&&(l.remove(c),P+=1,pa=m,g.ma(r.yb),b.Ba(0.01,m),c.update(),La(c.x,c.y,0.3)));pa?ja=0:(ja+=1,120<ja&&(P-=5));P=Math.clamp(P,0,1100);Ea=(1+0.0040*P)*(1+0.0040*P);r.na=0.0010*P;l.update();l.draw()};b.update=function(){H.pb=q;
H.getPointingEnd()&&(200>Date.now()-H.tb?H.pb=m:H.tb=Date.now());b.currentScene!==n&&l.clear()};var da,ka,cb;b.kb=function(){function a(b){return[{frame:10,aa:[[b,18,"ship","zako8"],[-b,18,"ship","zako8"]]}]}function c(a){return[{frame:10,aa:[[a+-3,19.5,"zakoS","zako7"],[a+-1.5,19.5,"zakoS","zako7"],[a+0,19.5,"zakoS","zako7"],[a+1.5,19.5,"zakoS","zako7"],[a+3,19.5,"zakoS","zako7"],[a+-3,18.5,"zakoS","zako7"],[a+-1.5,18.5,"zakoS","zako7"],[a+0,18.5,"zakoS","zako7"],[a+1.5,18.5,"zakoS","zako7"],[a+
3,18.5,"zakoS","zako7"],[a+-3,17.5,"zakoS","zako7"],[a+-1.5,17.5,"zakoS","zako7"],[a+0,17.5,"zakoS","zako7"],[a+1.5,17.5,"zakoS","zako7"],[a+3,17.5,"zakoS","zako7"]]}]}function d(a){return[{frame:10,aa:[[a+-3,17.5,"ship","zako6K"],[a+-1.5,17.5,"ship","zako6K"],[a+0,17.5,"ship","zako6K"],[a+1.5,17.5,"ship","zako6K"],[a+3,17.5,"ship","zako6K"]]}]}function g(a){return[{frame:10,aa:[[a+-3,17.5,"ship","zako6"],[a+-1.5,17.5,"ship","zako6"],[a+0,17.5,"ship","zako6"],[a+1.5,17.5,"ship","zako6"],[a+3,17.5,
"ship","zako6"]]}]}function j(a){return[{frame:10,aa:[[a+-3,17.5,"zako","zako5K"],[a+-1.5,17.5,"zako","zako5K"],[a+0,17.5,"zako","zako5K"],[a+1.5,17.5,"zako","zako5K"],[a+3,17.5,"zako","zako5K"]]}]}function v(a){return[{frame:10,aa:[[a+-3,17.5,"zako","zako5"],[a+-1.5,17.5,"zako","zako5"],[a+0,17.5,"zako","zako5"],[a+1.5,17.5,"zako","zako5"],[a+3,17.5,"zako","zako5"]]}]}function z(a){return[{frame:10,aa:[[a+-3,17.5,"zako","zako4K"],[a+-1.5,17.5,"zako","zako4K"],[a+0,17.5,"zako","zako4K"],[a+1.5,17.5,
"zako","zako4K"],[a+3,17.5,"zako","zako4K"]]}]}function E(a){return[{frame:10,aa:[[a+-3,17.5,"zako","zako4"],[a+-1.5,17.5,"zako","zako4"],[a+0,17.5,"zako","zako4"],[a+1.5,17.5,"zako","zako4"],[a+3,17.5,"zako","zako4"]]}]}l.frame=0;var N=b.wa;b.ba&&b.ba.stop();b.ba=f.get("bgm"+N);b.ba&&(b.ba.loop=m,setTimeout(function(){b.ba.play()},100));if(da!==k){l.remove(da);var t=Q.indexOf(da);-1!==t&&Q.splice(t,1)}var C=tm.util.Random,H=tm.sound.SoundManager,D=oa.Na,B=new F(Ha["boss"+N]);B.scale=8;B.alpha=0.5;
B.Cb=8;B.na=0.4;B.Qa=ta[N-1];B.ra=0;B.ma=function(a){this.ra+=a;var c=this.parent;if(0.5*B.Qa<this.ra){b.ab(m);H.get("explode").play();D(this.x+C.randfloat(-2,2),this.y+C.randfloat(-2,2),C.randfloat(1,2));D(this.x+C.randfloat(-2,2),this.y+C.randfloat(-2,2),C.randfloat(1,2));D(this.x+C.randfloat(-2,2),this.y+C.randfloat(-2,2),C.randfloat(1,2));var d=c.frame+50;this.update=function(){this.x=0.1*Math.sin(0.3*c.frame);d<c.frame&&(0===(c.frame-d)%5&&0.5>Math.random())&&(H.get("explode").play(),D(this.x+
C.randfloat(-3,3),this.y+C.randfloat(-3,3),C.randfloat(0.5,1)));c.frame===d+75&&(this.update=J["boss"+N+"2"].eb(b.Ob),this.ma=this.Wb)};this.ma=aa()}};B.Wb=function(a){this.ra+=a;var c=this.parent;if(B.Qa<this.ra){b.xb.disabled=m;b.ab(m);H.get("explode").play();D(this.x+C.randfloat(-2,2),this.y+C.randfloat(-2,2),C.randfloat(1,2));D(this.x+C.randfloat(-2,2),this.y+C.randfloat(-2,2),C.randfloat(1,2));D(this.x+C.randfloat(-2,2),this.y+C.randfloat(-2,2),C.randfloat(1,2));var d=c.frame+50;this.update=
function(){b.xb.disabled=m;this.alpha-=0.0010;this.na+=0.0010;this.Ma+=0.0020;this.x=0.1*Math.sin(0.3*c.frame);this.y+=-0.025;this.scale-=0.0010;this.rotation-=0.03;d<c.frame&&(0===(c.frame-d)%5&&0.5>Math.random())&&(H.get("explode").play(),D(this.x+C.randfloat(-3,3),this.y+C.randfloat(-3,3),C.randfloat(0.5,1)));if(c.frame===d+250){var a=this;oa.rb(c)(function(){a.cc()})}else c.frame===d+250+60&&(this.update=function(){this.alpha-=0.0010;0>=this.alpha&&c.remove(this)})};this.ma=aa()}};da=B;Q.push(da);
da.cc=function(){b.ic()};bb=Qa(da);ka&&ka.remove();var P=r;if(1===N){var u=tm.graphics.LinearGradient(0,0,0,320);u.addColorStopList([{offset:0,color:"rgba(0,0,255,0.3)"},{offset:1,color:"rgba(0,0,255,0.0)"}]);u=tm.app.RectangleShape(320,320,{fillStyle:u.toStyle(),strokeStyle:"none"});u.x=b.width/2;u.y=b.height/2;u.update=function(a){var b=this.canvas;b.clear();this.renderer(this._shapeParam);b.strokeStyle="rgba(255,255,255,0.3)";for(var c=1-0.02*P.x,d=0;20>d;d++){var f=0.2*(a.frame%15),f=(d+f)*(d+
f);b.drawLine(0,f/c,320,f*c)}};ka=u}else if(2===N){u=tm.graphics.RadialGradient(160,160,0,160,160,240);u.addColorStopList([{offset:0,color:"rgba(0,0,255,0.15)"},{offset:1,color:"rgba(0,0,255,0.10)"}]);t=tm.graphics.RadialGradient(160,160,0,160,160,240);t.addColorStopList([{offset:0,color:"rgba(255,255,255,0.0)"},{offset:1,color:"rgba(255,255,255,0.3)"}]);for(var L=[],h=-16;16>h;h++)L.push({z:h});u=tm.app.RectangleShape(320,320,{fillStyle:u.toStyle(),strokeStyle:"none"});u.x=b.width/2;u.y=b.height/
2;var h=mat4.identity(mat4.create()),M=mat4.identity(mat4.create()),U=mat4.identity(mat4.create());mat4.lookAt([0,0,0],[0,0,-1],[0,1,0],h);mat4.perspective(90,1,0.1,32,M);mat4.multiply(M,h,U);var ea=u.canvas;ea.strokeStyle=t.toStyle();u.update=function(a){var b=30*Math.cos(0.02*a.frame)+-4*P.x,c=30*Math.sin(0.02*a.frame)+4*P.y;ea.clear();this.renderer(this._shapeParam);for(var d=L.length;d--;){var f=L[d];f.z+=0.04;var g=vec4.create([b,c,f.z,1]);mat4.multiplyVec4(U,g);16<f.z?f.z-=32:0<g[3]&&ea.strokePolygon(g[0]/
g[3]+160,g[1]/g[3]+160,50/g[3],8,a.frame)}};ka=u}else if(3===N){u=tm.graphics.LinearGradient(0,0,0,320);u.addColorStopList([{offset:0,color:"rgba(0,0,255,0.00)"},{offset:0.5,color:"rgba(0,0,255,0.20)"},{offset:1,color:"rgba(0,0,255,0.00)"}]);t=tm.graphics.LinearGradient(0,0,320,0);t.addColorStopList([{offset:0,color:"rgba(255,255,255,0.30)"},{offset:0.5,color:"rgba(255,255,255,0.00)"},{offset:1,color:"rgba(255,255,255,0.30)"}]);u=tm.app.RectangleShape(320,320,{fillStyle:u.toStyle(),strokeStyle:"none"});
u.x=b.width/2;u.y=b.height/2;L=[];for(h=-5;16>h;h++)L.push({z:h});h=mat4.identity(mat4.create());M=mat4.identity(mat4.create());U=mat4.identity(mat4.create());mat4.lookAt([0,0,0],[0,0,-1],[0,1,0],h);mat4.perspective(90,1,0.1,32,M);mat4.multiply(M,h,U);ea=u.canvas;ea.strokeStyle=t.toStyle();u.update=function(){ea.clear();this.renderer(this._shapeParam);for(var a=L.length;a--;){var b=L[a];b.z+=0.05;var c=vec4.create([50,0,b.z,1]);mat4.multiplyVec4(U,c);16<b.z?b.z-=21:0<c[3]&&(b=c[0]/c[3],ea.drawLine(b+
160,0,b+160,320),ea.drawLine(-b+160,0,-b+160,320))}};ka=u}else ka=k;n.addChild(ka);var t=[{frame:20,aa:[]}],u=[{frame:40,aa:[]}],h=[{frame:60,aa:[]}],M=[{frame:120,aa:[[-17,16,"zako","zako1"],[-15,16.5,"zako","zako1"],[-13,17,"zako","zako1"],[-11,17,"zako","zako1"],[-9,17,"zako","zako1"],[-17,16,"zako","zako1d"],[-15,16.5,"zako","zako1d"],[-13,17,"zako","zako1d"],[-11,17,"zako","zako1d"],[-9,17,"zako","zako1d"]]}],fa=[{frame:120,aa:[[17,16,"zako","zako2"],[15,16.5,"zako","zako2"],[13,17,"zako","zako2"],
[11,17,"zako","zako2"],[9,17,"zako","zako2"],[17,16,"zako","zako2d"],[15,16.5,"zako","zako2d"],[13,17,"zako","zako2d"],[11,17,"zako","zako2d"],[9,17,"zako","zako2d"]]}],ga=[{frame:60,aa:[[-17,16,"zako","zako1"],[-15,16.5,"zako","zako1"],[-13,17,"zako","zako1"],[-11,17,"zako","zako1"],[-9,17,"zako","zako1"],[-17,16,"zako","zako1d"],[-15,16.5,"zako","zako1d"],[-13,17,"zako","zako1d"],[-11,17,"zako","zako1d"],[-9,17,"zako","zako1d"]]}],ia=[{frame:60,aa:[[17,16,"zako","zako2"],[15,16.5,"zako","zako2"],
[13,17,"zako","zako2"],[11,17,"zako","zako2"],[9,17,"zako","zako2"],[17,16,"zako","zako2d"],[15,16.5,"zako","zako2d"],[13,17,"zako","zako2d"],[11,17,"zako","zako2d"],[9,17,"zako","zako2d"]]}],na=[{frame:60,aa:[[-17,16,"zako","zako1"],[-15,16.5,"zako","zako1"],[-13,17,"zako","zako1"],[-11,17,"zako","zako1"],[-9,17,"zako","zako1"],[-17,16,"zako","zako1d"],[-15,16.5,"zako","zako1d"],[-13,17,"zako","zako1d"],[-11,17,"zako","zako1d"],[-9,17,"zako","zako1d"],[17,16,"zako","zako2"],[15,16.5,"zako","zako2"],
[13,17,"zako","zako2"],[11,17,"zako","zako2"],[9,17,"zako","zako2"],[17,16,"zako","zako2d"],[15,16.5,"zako","zako2d"],[13,17,"zako","zako2d"],[11,17,"zako","zako2d"],[9,17,"zako","zako2d"]]}],Ba=[{frame:5,aa:[[-8+4*Math.random()-2,17,"zako","zako3"]]}],Ca=[{frame:5,aa:[[8+4*Math.random()-2,17,"zako","zako3"]]}],R=[{frame:5,aa:[[-8+4*Math.random()-2,17,"zako","zako3"],[8+4*Math.random()-2,17,"zako","zako3"]]}],ha=[{frame:5,aa:[[-16.5,10,"tank","tank1"],[-16.5,8,"tank","tank1"],[-16.5,6,"tank","tank1"],
[-16.5,4,"tank","tank1"],[-16.5,2,"tank","tank1"],[-16.5,10,"tank","tank1d"],[-16.5,8,"tank","tank1d"],[-16.5,6,"tank","tank1d"],[-16.5,4,"tank","tank1d"],[-16.5,2,"tank","tank1d"]]}],ja=[{frame:5,aa:[[16.5,10,"tank","tank2"],[16.5,8,"tank","tank2"],[16.5,6,"tank","tank2"],[16.5,4,"tank","tank2"],[16.5,2,"tank","tank2"],[16.5,10,"tank","tank2d"],[16.5,8,"tank","tank2d"],[16.5,6,"tank","tank2d"],[16.5,4,"tank","tank2d"],[16.5,2,"tank","tank2d"]]}],sa=[{frame:5,aa:[[-16.5,10,"tank","tank1"],[-16.5,
8,"tank","tank1"],[-16.5,6,"tank","tank1"],[-16.5,4,"tank","tank1"],[-16.5,2,"tank","tank1"],[-16.5,10,"tank","tank1d"],[-16.5,8,"tank","tank1d"],[-16.5,6,"tank","tank1d"],[-16.5,4,"tank","tank1d"],[-16.5,2,"tank","tank1d"],[16.5,10,"tank","tank2"],[16.5,8,"tank","tank2"],[16.5,6,"tank","tank2"],[16.5,4,"tank","tank2"],[16.5,2,"tank","tank2"],[16.5,10,"tank","tank2d"],[16.5,8,"tank","tank2d"],[16.5,6,"tank","tank2d"],[16.5,4,"tank","tank2d"],[16.5,2,"tank","tank2d"]]}],ua=[{frame:10,aa:[[0,18,"middle",
"middle"]]}],va=[{frame:10,aa:[[5,18,"middle","middle"]]}],wa=[{frame:10,aa:[[-5,18,"middle","middle"]]}],xa=[{frame:10,aa:[[20,10,"middleK","middleKR"]]}],za=[{frame:100,aa:[[0,17,"bigger","bigger","flag1"]]}],Aa=[{Oa:"flag1",aa:[]}],pa=[{frame:10,aa:[[-7,19,"cannon","cannon"]]}],Ea=[{frame:10,aa:[[-2,19,"cannon","cannon"]]}],Fa=[{frame:10,aa:[[3,19,"cannon","cannon"]]}],ya=[{frame:10,aa:[[7,19,"cannon","cannon"]]}],Ga=[{frame:10,aa:[[-5,19,"cannon","cannon2"],[5,19,"cannon","cannon2"]]}],Ka=[{frame:10,
aa:[[-12,19,"cannon2","cannon3"],[12,19,"cannon2","cannon3"]]}],qa=[];1===N?qa=qa.concat(h).concat(h).concat(M).concat(fa).concat(h).concat(h).concat(ga).concat(h).concat(ia).concat(h).concat(na).concat(h).concat(h).concat(Ba).concat(Ba).concat(Ba).concat(Ba).concat(Ba).concat(h).concat(Ca).concat(Ca).concat(Ca).concat(Ca).concat(Ca).concat(h).concat(R).concat(R).concat(R).concat(R).concat(R).concat(h).concat(za).concat(Aa).concat(ja).concat(ha).concat(h).concat(R).concat(R).concat(R).concat(R).concat(R).concat(h).concat(pa).concat(R).concat(R).concat(R).concat(R).concat(R).concat(t).concat(ua).concat(va).concat(wa).concat(h).concat(h).concat(pa).concat(h).concat(h).concat(E(12)).concat(h).concat(ya).concat(h).concat(E(12)).concat(h).concat(h).concat(E(0)).concat(h).concat(ya).concat(v(-12)).concat(h).concat(h).concat(v(-12)).concat(h).concat(h).concat(v(-12)).concat(h).concat(h).concat(h).concat(Ea).concat(Fa).concat(ja).concat(ha).concat(g(8)).concat(h).concat(h).concat(g(-8)).concat(h).concat(h).concat(g(8)).concat(h).concat(h).concat(g(-8)).concat(h).concat(h).concat([{frame:10,
aa:[],message:{color:"red",text:"WARNING!!",visible:m}}]).concat(h).concat(h).concat(h).concat(h).concat(h).concat([{frame:10,aa:[],message:{color:"white",text:"",visible:q}}]).concat([{frame:20,aa:[[0,21.9,"boss","boss11"]]}]):2===N&&(qa=qa.concat(h).concat(h).concat(h).concat(h).concat(c(8)).concat(h).concat(h).concat(c(-8)).concat(h).concat(h).concat(c(8)).concat(h).concat(h).concat(c(-8)).concat(h).concat(h).concat(h).concat(c(8)).concat(h).concat(c(8)).concat(h).concat(c(8)).concat(h).concat(c(8)).concat(h).concat(c(8)).concat(h).concat(c(8)).concat(h).concat(c(8)).concat(h).concat(h).concat(a(4)).concat(h).concat(a(8)).concat(h).concat(a(12)).concat(h).concat(h).concat(h).concat(h).concat(j(-12)).concat(h).concat(j(-12)).concat(h).concat(j(-12)).concat(xa).concat(h).concat(h).concat(j(-12)).concat(h).concat(j(-12)).concat(h).concat(h).concat(d(8)).concat(t).concat(d(-8)).concat(t).concat(j(12)).concat(h).concat(j(12)).concat(h).concat(Ga).concat(sa).concat(h).concat(h).concat(Ka).concat(z(12)).concat(u).concat(z(12)).concat(u).concat(v(12)).concat(u).concat(v(12)).concat(u).concat(z(-12)).concat(u).concat(z(-12)).concat(u).concat(h).concat(h).concat(h).concat(h).concat(h).concat(h).concat(c(0)).concat(h).concat(c(1)).concat(h).concat(c(2)).concat(h).concat(c(3)).concat(h).concat(g(-11)).concat(t).concat(g(-13)).concat(t).concat(v(9)).concat(h).concat(v(12)).concat(h).concat(h).concat(h).concat([{frame:10,
aa:[],message:{color:"red",text:"WARNING!!",visible:m}}]).concat(h).concat(h).concat(h).concat(h).concat(h).concat([{frame:10,aa:[],message:{color:"white",text:"",visible:q}}]).concat([{frame:20,aa:[[-12,-21.9,"boss","boss21"]]}]));var ra=0,db=0;qa.next=function(a,b){var c;if(this[ra]!==k){if(db+this[ra].frame===a)c=this[ra];else if(b[this[ra].Oa]===m)c=this[ra];else return;ra++;db=a;return c}};cb=qa;r.reset();r.sa=m;r.disabled=m;r.y=-17;b.ab(m);b.Qb();b.Tb();b.Rb();b.Sb();s.text="stage "+N;s.setFontSize(50);
s.fillStyle="white";s.alpha=0.1;var La=l.frame;s.addEventListener("enterframe",function(){l.frame===La+240&&s.remove()});n.addChild(s)};b.ic=function(){if(2===b.wa)b.Yb();else{s.fillStyle="white";s.setFontSize(30);s.alpha=0.1;s.text="stage clear";s.visible=m;var a=l.frame,c=~~(1E5*b.qa+3E4*b.la);s.addEventListener("enterframe",function(){l.frame===a+180?(s.text="bonus "+c,b.Ba(c,q)):l.frame===a+360&&setTimeout(function(){b.wa+=1;b.kb()},10)});n.addChild(s)}};b.Yb=function(){s.fillStyle="white";s.setFontSize(30);
s.text="all stage clear";s.visible=m;var a=l.frame,c=~~(1E5*b.qa+1E4*b.la);s.addEventListener("enterframe",function(){if(l.frame===a+180)s.text="bonus "+c,b.Ba(c,q);else if(l.frame===a+360)s.fillStyle="yellow",s.text="THANK YOU!!";else if(l.frame===a+540)return b.fb()});n.addChild(s)};b.Vb=function(){l.gc=l.frame;setTimeout(function(){b.pushScene(Ga)},1E3)};b.Zb=function(){b.Sa();b.va+=1;r.ca=-1;l.frame=l.gc;l.add(r);r.vb()};b.fb=function(){b.ba&&b.ba.stop();b.replaceScene(L)};b.run()});
